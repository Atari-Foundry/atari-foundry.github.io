{"pageProps":{"product":"crucible","productDocs":{"product":"crucible","files":[{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/README.md","relativePath":"README.md","relativeDir":"","filename":"README","slug":"readme","name":"README"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/API_REFERENCE.md","relativePath":"API_REFERENCE.md","relativeDir":"","filename":"API_REFERENCE","slug":"api-reference","name":"API REFERENCE"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ARCHITECTURE.md","relativePath":"ARCHITECTURE.md","relativeDir":"","filename":"ARCHITECTURE","slug":"architecture","name":"ARCHITECTURE"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ATTRIBUTIONS.md","relativePath":"ATTRIBUTIONS.md","relativeDir":"","filename":"ATTRIBUTIONS","slug":"attributions","name":"ATTRIBUTIONS"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/BUILDING.md","relativePath":"BUILDING.md","relativeDir":"","filename":"BUILDING","slug":"building","name":"BUILDING"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/CHANGELOG.md","relativePath":"CHANGELOG.md","relativeDir":"","filename":"CHANGELOG","slug":"changelog","name":"CHANGELOG"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/USER_GUIDE.md","relativePath":"USER_GUIDE.md","relativeDir":"","filename":"USER_GUIDE","slug":"user-guide","name":"USER GUIDE"}],"navTree":{"_files":[{"name":"README","slug":"readme","path":"README.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/README.md","isIndex":true},{"name":"API REFERENCE","slug":"api-reference","path":"API_REFERENCE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/API_REFERENCE.md","isIndex":false},{"name":"ARCHITECTURE","slug":"architecture","path":"ARCHITECTURE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ARCHITECTURE.md","isIndex":false},{"name":"ATTRIBUTIONS","slug":"attributions","path":"ATTRIBUTIONS.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ATTRIBUTIONS.md","isIndex":false},{"name":"BUILDING","slug":"building","path":"BUILDING.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/BUILDING.md","isIndex":false},{"name":"CHANGELOG","slug":"changelog","path":"CHANGELOG.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/CHANGELOG.md","isIndex":false},{"name":"USER GUIDE","slug":"user-guide","path":"USER_GUIDE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/USER_GUIDE.md","isIndex":false}]}},"docFile":{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/CHANGELOG.md","relativePath":"CHANGELOG.md","relativeDir":"","filename":"CHANGELOG","slug":"changelog","name":"CHANGELOG","content":"# Changelog\n\nAll notable changes to crucible will be documented in this file.\n\nThe format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),\nand this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).\n\n## [Unreleased] - 2026-01-21\n\n### Added\n\n- **ATR Filesystem Support**: Full ATR image filesystem access for D: device\n  - Directory parsing for DOS 2.x, SpartaDOS, and BW-DOS formats\n  - VTOC (Volume Table of Contents) reading\n  - Sector chain following for file data access\n  - Subdirectory navigation support\n  - File attribute handling (locked, hidden, protected files)\n  - Directory listing with SpartaDOS-style formatting\n  - Support for ATR images up to 16MB (65535 sectors Ã— 256 bytes)\n\n- **H: Device**: New host filesystem device\n  - Provides access to local host filesystem\n  - Supports all standard file operations (OPEN, CLOSE, GET, PUT, POINT, NOTE)\n  - Directory read support (mode 6)\n  - Allows simultaneous access to ATR images (D:) and host files (H:)\n  - Configurable root path via `-R` command-line option\n\n- **Enhanced Hardware Emulation**:\n  - **POKEY**: Added support for audio/timer registers\n    - AUDF1-4 ($D200, $D202, $D204, $D206) - Audio frequency registers\n    - AUDC1-4 ($D201, $D203, $D205, $D207) - Audio control registers\n    - AUDCTL ($D208) - Audio control register\n    - KBCODE ($D209) - Keyboard code register\n    - POT0-7 ($D200-$D207 when reading) - Potentiometer inputs\n  - **GTIA**: Added register stubs for all GTIA registers ($D000-$D01F)\n    - Player/Missile graphics registers\n    - Color registers\n    - Priority and control registers\n  - **ANTIC**: Added register stubs for all ANTIC registers ($D400-$D40E)\n    - DMA control, display list, scroll registers\n    - Light pen and NMI registers\n  - **PIA**: Enhanced support\n    - PORTA register for joystick/paddle inputs\n    - Control register support (PACTL, PBCTL)\n\n- **Build System Improvements**:\n  - Added `make clean` target for cleaning build artifacts\n  - Added `make help` target for usage information\n  - Added `make test` target for automated testing\n\n- **Documentation**:\n  - Comprehensive documentation in `docs/` folder\n  - User guide, architecture documentation, API reference\n  - Build instructions and troubleshooting guides\n\n### Changed\n\n- **D: Device**: Now exclusively uses ATR filesystem when ATR image is loaded\n  - Removed host filesystem fallback (use H: device instead)\n  - Full directory parsing and file access from ATR images\n  - Enhanced directory listing format with file attributes\n\n- **H: Device Root Path**: Now configurable via `-R` command-line option\n  - Previously defaulted to current directory (`.`)\n  - Now uses same root path as D: device when `-R` is specified\n  - Maintains backward compatibility with default behavior\n\n- **Platform Compatibility**:\n  - Improved cross-platform support for terminal input handling\n  - Windows: Uses `CONIN$` for terminal input\n  - Unix/Linux: Uses `/dev/tty` for terminal input\n\n- **CIO System**:\n  - Fixed RTS callback simulation in `sim_CIOV` for proper return address handling\n  - Fixed stack preservation in `call_devtab` to prevent corruption from nested calls\n  - All CIO operations now work correctly with proper return handling\n\n### Fixed\n\n- **CIO Return Handling**: Fixed critical bug where CIOV callbacks were not properly returning to caller\n  - Implemented RTS simulation in `sim_CIOV` to properly handle return addresses\n  - Fixed stack corruption in nested device handler calls\n  - All test programs now execute successfully\n\n- **Hardcoded Paths**: Removed hardcoded filesystem paths\n  - Made `/dev/tty` platform-specific with proper Windows support\n  - Made H: device root path configurable via command-line\n\n### Technical Details\n- New modules:\n  - `src/atrfs.c` / `src/atrfs.h` - ATR filesystem implementation\n  - `src/athost.c` / `src/athost.h` - H: device handler\n- Modified modules:\n  - `src/atsio.c` / `src/atsio.h` - Added ATR access API\n  - `src/ataridos.c` - Integrated ATR filesystem\n  - `src/atcio.c` - Registered H: device, fixed RTS callback handling\n  - `src/hw.c` - Enhanced hardware register support\n  - `src/ciodev.h` - Added H: device definitions\n  - `src/main.c` - Added H: device root path configuration\n  - `src/atari.c` - Improved cross-platform terminal handling\n\n## Previous Versions\n\nSee git history for earlier changes from the original Mini65 project.\n"},"currentPath":"changelog"},"__N_SSG":true}