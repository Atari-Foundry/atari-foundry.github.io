{"pageProps":{"product":"crucible","productDocs":{"product":"crucible","files":[{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/README.md","relativePath":"README.md","relativeDir":"","filename":"README","slug":"readme","name":"README"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/API_REFERENCE.md","relativePath":"API_REFERENCE.md","relativeDir":"","filename":"API_REFERENCE","slug":"api-reference","name":"API REFERENCE"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ARCHITECTURE.md","relativePath":"ARCHITECTURE.md","relativeDir":"","filename":"ARCHITECTURE","slug":"architecture","name":"ARCHITECTURE"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ATTRIBUTIONS.md","relativePath":"ATTRIBUTIONS.md","relativeDir":"","filename":"ATTRIBUTIONS","slug":"attributions","name":"ATTRIBUTIONS"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/BUILDING.md","relativePath":"BUILDING.md","relativeDir":"","filename":"BUILDING","slug":"building","name":"BUILDING"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/CHANGELOG.md","relativePath":"CHANGELOG.md","relativeDir":"","filename":"CHANGELOG","slug":"changelog","name":"CHANGELOG"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/USER_GUIDE.md","relativePath":"USER_GUIDE.md","relativeDir":"","filename":"USER_GUIDE","slug":"user-guide","name":"USER GUIDE"}],"navTree":{"_files":[{"name":"README","slug":"readme","path":"README.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/README.md","isIndex":true},{"name":"API REFERENCE","slug":"api-reference","path":"API_REFERENCE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/API_REFERENCE.md","isIndex":false},{"name":"ARCHITECTURE","slug":"architecture","path":"ARCHITECTURE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ARCHITECTURE.md","isIndex":false},{"name":"ATTRIBUTIONS","slug":"attributions","path":"ATTRIBUTIONS.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ATTRIBUTIONS.md","isIndex":false},{"name":"BUILDING","slug":"building","path":"BUILDING.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/BUILDING.md","isIndex":false},{"name":"CHANGELOG","slug":"changelog","path":"CHANGELOG.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/CHANGELOG.md","isIndex":false},{"name":"USER GUIDE","slug":"user-guide","path":"USER_GUIDE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/USER_GUIDE.md","isIndex":false}]}},"docFile":{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/USER_GUIDE.md","relativePath":"USER_GUIDE.md","relativeDir":"","filename":"USER_GUIDE","slug":"user-guide","name":"USER GUIDE","content":"# Crucible User Guide\n\n## Table of Contents\n\n1. [Introduction](#introduction)\n2. [Installation](#installation)\n3. [Quick Start](#quick-start)\n4. [Command-Line Options](#command-line-options)\n5. [Device Support](#device-support)\n6. [File Formats](#file-formats)\n7. [Examples](#examples)\n8. [Troubleshooting](#troubleshooting)\n\n## Introduction\n\nCrucible is a small 6502 simulator designed to debug and run command-line (console-only) Atari 8-bit programs. It provides a subset of the Atari BIOS and hardware emulation, making it ideal for testing and debugging Atari software without requiring a full emulator.\n\n### Key Features\n\n- **6502 CPU Emulation**: Full 6502 instruction set support\n- **Atari BIOS Emulation**: CIO, DOS, and hardware register support\n- **ATR Filesystem Access**: Read files from ATR disk images\n- **Host Filesystem Access**: Access local files via H: device\n- **Hardware Emulation**: POKEY, GTIA, ANTIC, PIA registers\n- **Debugging Support**: Tracing, profiling, and label files\n- **Cross-Platform**: Works on Linux, macOS, and Windows\n\n## Installation\n\n### Prerequisites\n\n- GCC compiler (or compatible C compiler)\n- Make\n- Standard C library\n- Math library (`-lm`)\n\n### Building from Source\n\n```bash\n# Clone or download the source code\ncd crucible\n\n# Build the project\nmake\n\n# The executable will be in build/crucible\n./build/crucible -h\n```\n\n### Build Options\n\n- `make` - Build the project\n- `make clean` - Remove all build artifacts\n- `make help` - Show build system help\n- `make test` - Run automated tests\n\n## Quick Start\n\n### Running a Simple Program\n\n```bash\n# Run a XEX file\n./build/crucible program.xex\n\n# Run with debug output\n./build/crucible -d program.xex\n\n# Run with ATR disk image\n./build/crucible -I disk.atr program.xex\n```\n\n### Basic Examples\n\n```bash\n# Print \"HELLO\" (if you have hello.xex)\n./build/crucible testfiles/hello.xex\n\n# Access host filesystem\n./build/crucible -R /path/to/files program.xex\n\n# Boot from ATR image\n./build/crucible -I disk.atr\n```\n\n## Command-Line Options\n\n### Basic Options\n\n- `-h` - Show help message\n- `-d` - Print debug messages to standard error\n- `-b` - Use binary mode for standard input/output (no ATASCII translation)\n- `-D` - Don't emulate DOS device\n\n### File Options\n\n- `-I <file>` - Load ATR disk image for SIO emulation\n  - If no executable is given, boots from this image\n  - Example: `-I disk.atr`\n\n- `-R <path>` - Set root path for D: and H: devices\n  - Sets the base directory for file access\n  - Example: `-R /home/user/atari_files`\n\n- `-r <addr>` - Load ROM at given address instead of XEX file\n  - Address can be in decimal or hexadecimal (0x prefix)\n  - Example: `-r 0xC000`\n\n### Debugging Options\n\n- `-e <level>` - Set error level\n  - `none` or `n` - No error reporting\n  - `mem` or `m` - Memory errors only\n  - `full` or `f` - All errors (default)\n  - Example: `-e mem`\n\n- `-t <file>` - Store simulation trace to file\n  - Records instruction execution trace\n  - Example: `-t trace.txt`\n\n- `-l <file>` - Load label file for trace output\n  - Makes trace output more readable\n  - Can specify multiple times (last one takes precedence)\n  - Example: `-l labels.txt`\n\n### Profiling Options\n\n- `-p <file>` - Store profile information to file\n  - Text format profile data\n  - Example: `-p profile.txt`\n\n- `-P <file>` - Read/write binary profile data\n  - Can consolidate multiple profile runs\n  - Example: `-P profile.bin`\n\n### Advanced Options (`-o`)\n\n- `ntsc` - Emulate NTSC machine timings (60Hz) - **default**\n- `pal` - Emulate PAL machine timings (50Hz)\n- `realtime` - Base time on real elapsed times - **default**\n- `cycletime` - Base time on number of CPU cycles\n- `fastmath` - Use Altirra fast math pack - **default**\n- `atarimath` - Use original Atari math pack\n\nMultiple options can be specified: `-o ntsc,fastmath`\n\n### Usage Examples\n\n```bash\n# Full debugging session\n./build/crucible -d -t trace.txt -l labels.txt program.xex\n\n# Profile a program\n./build/crucible -p profile.txt program.xex\n\n# Run with ATR image and custom root path\n./build/crucible -I disk.atr -R /data/atari program.xex\n\n# PAL timing with original math pack\n./build/crucible -o pal,atarimath program.xex\n```\n\n## Device Support\n\n### E: Device (Editor/Screen)\n\n- **Purpose**: Standard input/output\n- **Input**: Reads from standard input (stdin)\n- **Output**: Writes to standard output (stdout)\n- **Translation**: ATASCII to/from ASCII (unless `-b` flag used)\n\n### D: Device (Disk)\n\n- **Purpose**: ATR disk image access\n- **Format**: DOS 2.x, SpartaDOS, BW-DOS\n- **Features**:\n  - File reading from ATR images\n  - Directory listing\n  - Subdirectory navigation\n  - File attribute support\n- **Usage**: Load with `-I` option\n- **Limitations**: Read-only (no file writing to ATR)\n\n### H: Device (Host)\n\n- **Purpose**: Host filesystem access\n- **Features**:\n  - File reading and writing\n  - Directory listing\n  - Full CIO compatibility\n- **Root Path**: Set with `-R` option (defaults to current directory)\n- **Example**: `H1:FILE.TXT` accesses `FILE.TXT` in root path\n\n### K: Device (Keyboard)\n\n- **Purpose**: Character input from console\n- **Features**: Single character input with ATASCII translation\n\n### R: Device (RS-232/Serial)\n\n- **Purpose**: Serial I/O emulation\n- **Features**:\n  - Baud rate configuration\n  - Translation mode support\n  - Basic serial communication\n\n## File Formats\n\n### XEX Files\n\n- **Format**: Atari executable format\n- **Extension**: `.xex`\n- **Structure**: Multiple segments with load addresses\n- **Usage**: Primary format for running Atari programs\n\n### ATR Files\n\n- **Format**: Atari disk image format\n- **Extension**: `.atr`\n- **Structure**: Header + sector data\n- **Sizes**: Up to 16MB supported (65535 sectors Ã— 256 bytes)\n- **Sector Sizes**: 128 or 256 bytes per sector\n- **Usage**: Load with `-I` option\n\n### Label Files\n\n- **Format**: Text file with address labels\n- **Purpose**: Makes trace output readable\n- **Format**: `LABEL = $ADDRESS` or `LABEL = ADDRESS`\n- **Example**:\n  ```\n  MAIN = $0600\n  LOOP = $0620\n  ```\n\n## Examples\n\n### Example 1: Simple Program Execution\n\n```bash\n# Run a hello world program\n./build/crucible hello.xex\n# Output: HELLO\n```\n\n### Example 2: Debugging with Trace\n\n```bash\n# Create a label file (labels.txt)\necho \"MAIN = \\$0600\" > labels.txt\necho \"LOOP = \\$0620\" >> labels.txt\n\n# Run with trace\n./build/crucible -d -t trace.txt -l labels.txt program.xex\n```\n\n### Example 3: Working with ATR Images\n\n```bash\n# Boot from ATR image\n./build/crucible -I disk.atr\n\n# Run program with ATR image loaded\n./build/crucible -I disk.atr program.xex\n```\n\n### Example 4: Host Filesystem Access\n\n```bash\n# Set root path and run program\n./build/crucible -R /home/user/atari_files program.xex\n\n# Program can access files via H: device\n# H1:FILE.TXT maps to /home/user/atari_files/FILE.TXT\n```\n\n### Example 5: Profiling\n\n```bash\n# Generate profile\n./build/crucible -p profile.txt program.xex\n\n# View profile (shows cycle counts per instruction)\ncat profile.txt\n```\n\n## Troubleshooting\n\n### Program Doesn't Run\n\n- **Check file format**: Ensure file is valid XEX format\n- **Check debug output**: Use `-d` flag to see what's happening\n- **Check error level**: Use `-e full` to see all errors\n\n### ATR Image Not Loading\n\n- **Check file format**: Ensure ATR has valid header\n- **Check file size**: Supported up to 16MB\n- **Check sector size**: Must be 128 or 256 bytes\n\n### File Access Issues\n\n- **D: Device**: Requires ATR image loaded with `-I`\n- **H: Device**: Check root path with `-R` option\n- **Permissions**: Ensure files are readable/writable\n\n### Debug Output Too Verbose\n\n- **Use error levels**: `-e mem` or `-e none`\n- **Filter output**: Redirect stderr to file\n- **Use labels**: Makes trace output more readable\n\n### Performance Issues\n\n- **Use cycle-based timing**: `-o cycletime`\n- **Disable DOS**: `-D` flag if not needed\n- **Reduce debug output**: Remove `-d` flag\n\n### Common Error Messages\n\n- **\"can't open disk image\"**: Check file path and permissions\n- **\"invalid instruction\"**: Program may have bugs or incompatible code\n- **\"channel not open\"**: Program trying to access closed IOCB\n- **\"invalid command\"**: Unsupported CIO command\n\n### Getting Help\n\n- Use `-h` flag for command-line help\n- Check documentation in `docs/` folder\n- Review test files in `testfiles/` for examples\n- Enable debug output with `-d` flag\n\n## Advanced Usage\n\n### Custom I/O Handlers\n\nThe simulator supports custom character I/O handlers through the API (see API_REFERENCE.md for details).\n\n### Label File Format\n\nLabels can be specified in multiple formats:\n- `LABEL = $1234` (hexadecimal)\n- `LABEL = 1234` (decimal)\n- `LABEL = 0x1234` (hexadecimal with 0x prefix)\n\n### Profile Analysis\n\nProfile files show:\n- Cycle counts per instruction address\n- Branch statistics\n- Memory access patterns\n- Performance hotspots\n\n### Trace Analysis\n\nTrace files show:\n- Instruction execution sequence\n- Register values\n- Memory accesses\n- Call stack information\n\n## See Also\n\n- [Architecture Documentation](ARCHITECTURE.md) - Technical details\n- [API Reference](API_REFERENCE.md) - Developer documentation\n- [Building Guide](BUILDING.md) - Build system details\n- [Changelog](CHANGELOG.md) - Version history\n"},"currentPath":"user-guide"},"__N_SSG":true}