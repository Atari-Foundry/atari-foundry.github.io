{"pageProps":{"product":"crucible","productDocs":{"product":"crucible","files":[{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/README.md","relativePath":"README.md","relativeDir":"","filename":"README","slug":"readme","name":"README"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/API_REFERENCE.md","relativePath":"API_REFERENCE.md","relativeDir":"","filename":"API_REFERENCE","slug":"api-reference","name":"API REFERENCE"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ARCHITECTURE.md","relativePath":"ARCHITECTURE.md","relativeDir":"","filename":"ARCHITECTURE","slug":"architecture","name":"ARCHITECTURE"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ATTRIBUTIONS.md","relativePath":"ATTRIBUTIONS.md","relativeDir":"","filename":"ATTRIBUTIONS","slug":"attributions","name":"ATTRIBUTIONS"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/BUILDING.md","relativePath":"BUILDING.md","relativeDir":"","filename":"BUILDING","slug":"building","name":"BUILDING"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/CHANGELOG.md","relativePath":"CHANGELOG.md","relativeDir":"","filename":"CHANGELOG","slug":"changelog","name":"CHANGELOG"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/USER_GUIDE.md","relativePath":"USER_GUIDE.md","relativeDir":"","filename":"USER_GUIDE","slug":"user-guide","name":"USER GUIDE"}],"navTree":{"_files":[{"name":"README","slug":"readme","path":"README.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/README.md","isIndex":true},{"name":"API REFERENCE","slug":"api-reference","path":"API_REFERENCE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/API_REFERENCE.md","isIndex":false},{"name":"ARCHITECTURE","slug":"architecture","path":"ARCHITECTURE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ARCHITECTURE.md","isIndex":false},{"name":"ATTRIBUTIONS","slug":"attributions","path":"ATTRIBUTIONS.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ATTRIBUTIONS.md","isIndex":false},{"name":"BUILDING","slug":"building","path":"BUILDING.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/BUILDING.md","isIndex":false},{"name":"CHANGELOG","slug":"changelog","path":"CHANGELOG.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/CHANGELOG.md","isIndex":false},{"name":"USER GUIDE","slug":"user-guide","path":"USER_GUIDE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/USER_GUIDE.md","isIndex":false}]}},"docFile":{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/BUILDING.md","relativePath":"BUILDING.md","relativeDir":"","filename":"BUILDING","slug":"building","name":"BUILDING","content":"# Building Crucible\n\n## Table of Contents\n\n1. [Prerequisites](#prerequisites)\n2. [Quick Build](#quick-build)\n3. [Build Options](#build-options)\n4. [Platform-Specific Instructions](#platform-specific-instructions)\n5. [Troubleshooting](#troubleshooting)\n\n## Prerequisites\n\n### Required\n\n- **C Compiler**: GCC 4.8+ or compatible (Clang, MSVC)\n- **Make**: GNU Make 3.81+ or compatible\n- **Standard C Library**: POSIX-compliant C library\n- **Math Library**: Standard math library (`libm`)\n\n### Optional\n\n- **Git**: For version control\n- **Debugger**: GDB or compatible for debugging\n\n## Quick Build\n\n### Standard Build\n\n```bash\n# Clone or download source\ncd crucible\n\n# Build\nmake\n\n# Executable will be in build/crucible\n./build/crucible -h\n```\n\n### Clean Build\n\n```bash\n# Remove all build artifacts\nmake clean\n\n# Rebuild\nmake\n```\n\n## Build Options\n\n### Make Targets\n\n- `make` or `make all` - Build project (default)\n- `make clean` - Remove all build artifacts\n- `make help` - Show build system help\n- `make test` - Run automated tests\n\n### Compiler Options\n\nThe Makefile uses these default flags:\n\n```makefile\nCFLAGS = -Iccan -O3 -Wall -g -flto\nLDLIBS = -lm\n```\n\n**Flags Explained**:\n- `-Iccan`: Include path for ccan library\n- `-O3`: Maximum optimization\n- `-Wall`: Enable all warnings\n- `-g`: Include debug symbols\n- `-flto`: Link-time optimization\n- `-lm`: Link math library\n\n### Custom Build Options\n\n#### Debug Build\n\n```bash\nmake CFLAGS=\"-g -O0 -Wall\"\n```\n\n#### Release Build (No Debug Symbols)\n\n```bash\nmake CFLAGS=\"-O3 -flto -DNDEBUG\"\n```\n\n#### Custom Compiler\n\n```bash\nmake CC=clang\n```\n\n#### Disable LTO\n\n```bash\nmake CFLAGS=\"-Iccan -O3 -Wall -g\"\n```\n\n## Build System Details\n\n### Directory Structure\n\n```\ncrucible/\n├── build/          # Build output (created)\n│   ├── obj/        # Object files\n│   └── crucible    # Executable\n├── src/            # Source files\n├── ccan/           # C library headers\n├── asm/            # Assembly sources\n└── Makefile        # Build configuration\n```\n\n### Source Files\n\n**Core**:\n- `src/sim65.c` - CPU simulator\n- `src/atari.c` - BIOS emulation\n- `src/atcio.c` - CIO system\n- `src/main.c` - Main program\n\n**Devices**:\n- `src/ataridos.c` - D: device\n- `src/athost.c` - H: device\n- `src/atrdev.c` - R: device\n- `src/atsio.c` - SIO emulation\n\n**Filesystem**:\n- `src/atrfs.c` - ATR filesystem\n- `src/dosfname.c` - DOS filename handling\n\n**Hardware**:\n- `src/hw.c` - Hardware registers\n\n**Math**:\n- `src/mathpack.c` - Math pack integration\n\n### Dependencies\n\n**Internal**:\n- `ccan/` - C library headers (included in source)\n\n**External**:\n- Standard C library (`libc`)\n- Math library (`libm`)\n- No other external dependencies\n\n### Build Process\n\n1. **Compilation**: Each `.c` file compiled to `.o` object file\n2. **Linking**: All object files linked into executable\n3. **LTO**: Link-time optimization (if enabled) optimizes across files\n\n## Platform-Specific Instructions\n\n### Linux\n\n**Requirements**:\n- GCC or Clang\n- Make\n- Standard development tools\n\n**Build**:\n```bash\nmake\n```\n\n**Install** (optional):\n```bash\nsudo cp build/crucible /usr/local/bin/\n```\n\n### macOS\n\n**Requirements**:\n- Xcode Command Line Tools\n- Make (included with Xcode)\n\n**Build**:\n```bash\nmake\n```\n\n**Note**: May need to install Xcode Command Line Tools:\n```bash\nxcode-select --install\n```\n\n### Windows\n\n**Option 1: MinGW/MSYS2**\n\n```bash\n# Install MSYS2, then:\npacman -S mingw-w64-x86_64-gcc make\n\n# Build\nmake CC=x86_64-w64-mingw32-gcc\n```\n\n**Option 2: Visual Studio**\n\n1. Open Developer Command Prompt\n2. Navigate to source directory\n3. Use NMake or convert Makefile to Visual Studio project\n\n**Option 3: WSL (Windows Subsystem for Linux)**\n\nUse Linux build instructions in WSL environment.\n\n### Cross-Compilation\n\n**Example: Build for ARM**\n\n```bash\nmake CC=arm-linux-gnueabihf-gcc\n```\n\n**Example: Build for 32-bit**\n\n```bash\nmake CC=gcc CFLAGS=\"-Iccan -O3 -Wall -g -m32\"\n```\n\n## Troubleshooting\n\n### Build Errors\n\n#### \"Command not found: gcc\"\n\n**Solution**: Install GCC compiler\n- Linux: `sudo apt-get install gcc` (Debian/Ubuntu)\n- macOS: Install Xcode Command Line Tools\n- Windows: Install MinGW or use WSL\n\n#### \"fatal error: sim65.h: No such file or directory\"\n\n**Solution**: Ensure you're in the project root directory\n```bash\ncd /path/to/crucible\nmake clean\nmake\n```\n\n#### \"undefined reference to `sqrt`\"\n\n**Solution**: Link math library (should be automatic, but try):\n```bash\nmake LDLIBS=\"-lm\"\n```\n\n#### LTO Errors\n\n**Solution**: Disable LTO\n```bash\nmake CFLAGS=\"-Iccan -O3 -Wall -g\"\n```\n\n### Runtime Errors\n\n#### \"can't open disk image\"\n\n**Solution**: Check file path and permissions\n```bash\nls -l disk.atr\nchmod 644 disk.atr\n```\n\n#### Segmentation Fault\n\n**Solution**: Build with debug symbols and use debugger\n```bash\nmake CFLAGS=\"-g -O0 -Wall\"\ngdb ./build/crucible\n```\n\n### Performance Issues\n\n#### Slow Execution\n\n**Solutions**:\n- Enable optimizations: `make CFLAGS=\"-Iccan -O3 -flto -Wall\"`\n- Disable debug output: Remove `-d` flag\n- Use cycle-based timing: `-o cycletime`\n\n#### Large Binary Size\n\n**Solution**: Strip debug symbols\n```bash\nstrip build/crucible\n```\n\n## Advanced Build Configuration\n\n### Custom Makefile Variables\n\nEdit `Makefile` or override on command line:\n\n```bash\n# Custom compiler\nmake CC=clang\n\n# Custom flags\nmake CFLAGS=\"-Iccan -O2 -Wall -g -DDEBUG\"\n\n# Custom build directory\nmake BDIR=output\n```\n\n### Separate Debug/Release Builds\n\n```bash\n# Debug build\nmkdir -p build-debug\nmake BDIR=build-debug CFLAGS=\"-Iccan -g -O0 -Wall\"\n\n# Release build\nmkdir -p build-release\nmake BDIR=build-release CFLAGS=\"-Iccan -O3 -flto -Wall -DNDEBUG\"\n```\n\n### Static Linking\n\n```bash\nmake LDFLAGS=\"-static\"\n```\n\n### 32-bit Build\n\n```bash\nmake CFLAGS=\"-Iccan -O3 -Wall -g -m32\" LDFLAGS=\"-m32\"\n```\n\n## Testing the Build\n\n### Run Tests\n\n```bash\nmake test\n```\n\n### Manual Test\n\n```bash\n# Test help\n./build/crucible -h\n\n# Test with sample program\n./build/crucible testfiles/hello.xex\n```\n\n## Installation\n\n### System-Wide Installation\n\n**Linux/macOS**:\n```bash\nsudo cp build/crucible /usr/local/bin/\n```\n\n**User Installation**:\n```bash\ncp build/crucible ~/bin/\n# Add ~/bin to PATH if not already\n```\n\n### Create Package\n\n**Debian/Ubuntu**:\n```bash\n# Create .deb package (requires packaging tools)\ndpkg-buildpackage -us -uc\n```\n\n## Development Build\n\n### Enable All Warnings\n\n```bash\nmake CFLAGS=\"-Iccan -Wall -Wextra -Wpedantic -g -O0\"\n```\n\n### Address Sanitizer\n\n```bash\nmake CFLAGS=\"-Iccan -g -O0 -fsanitize=address\" LDLIBS=\"-lm -fsanitize=address\"\n```\n\n### Valgrind Support\n\n```bash\nmake CFLAGS=\"-Iccan -g -O0\"\nvalgrind ./build/crucible program.xex\n```\n\n## See Also\n\n- [User Guide](USER_GUIDE.md) - Usage instructions\n- [Architecture](ARCHITECTURE.md) - System design\n- [API Reference](API_REFERENCE.md) - Developer API\n"},"currentPath":"building"},"__N_SSG":true}