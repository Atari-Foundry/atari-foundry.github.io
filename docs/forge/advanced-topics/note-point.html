<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><title data-next-head="">note-point | forge Documentation | Atari Foundry</title><meta name="description" content="forge documentation: note-point" data-next-head=""/><link rel="preload" href="/images/foundry_logo_50H.png" as="image" data-next-head=""/><link rel="preload" href="/_next/static/chunks/c81f129e50a5fd79.css" as="style"/><link rel="stylesheet" href="/_next/static/chunks/c81f129e50a5fd79.css" data-n-g=""/><noscript data-n-css=""></noscript><script src="/_next/static/chunks/e8a4a4ae55bc5744.js" defer=""></script><script src="/_next/static/chunks/00dac80f236dcabb.js" defer=""></script><script src="/_next/static/chunks/44f6bc00d9aaf830.js" defer=""></script><script src="/_next/static/chunks/fd7cb30d70431a0f.js" defer=""></script><script src="/_next/static/chunks/turbopack-4769270d21ef6607.js" defer=""></script><script src="/_next/static/chunks/1b081b821847ed60.js" defer=""></script><script src="/_next/static/chunks/39b01aa8a3352426.js" defer=""></script><script src="/_next/static/chunks/b56fd671c61106a7.js" defer=""></script><script src="/_next/static/chunks/turbopack-ab1a8023ffca1f9c.js" defer=""></script><script src="/_next/static/uKcVMkypfjITnNYGcdC5l/_ssgManifest.js" defer=""></script><script src="/_next/static/uKcVMkypfjITnNYGcdC5l/_buildManifest.js" defer=""></script></head><body><div id="__next"><div class="crt"><div class="scanlines" aria-hidden="true"></div><div class="noise" aria-hidden="true"></div><nav class="nav"><a class="nav-brand" href="/"><img alt="Atari Foundry icon" width="72" height="50" decoding="async" data-nimg="1" style="color:transparent;height:40px;width:auto" src="/images/foundry_logo_50H.png"/><div><span class="nav-brand-title">Atari Foundry</span><span class="nav-brand-sub">Products for Atari 8-bit</span></div></a><ul class="nav-links"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/vault">Vault</a></li><li class="nav-item has-children"><button type="button" class="nav-link nav-trigger active" aria-haspopup="true" aria-expanded="false">Docs</button><div class="nav-dropdown"><a class="nav-dropdown-link" href="/docs/crucible">Crucible</a><a class="nav-dropdown-link" href="/docs/atrforge">atrforge</a><a class="nav-dropdown-link" href="/docs/forge">FORGE</a></div></li><li class="nav-item"><a class="nav-link" href="/support">Support</a></li></ul></nav><header class="subhero"><p class="label">forge<!-- --> Documentation</p><h1 class="page-title">note-point</h1></header><main><div class="docs-layout"><aside class="docs-sidebar"><nav class="docs-nav"><div class="docs-nav-section"><h3>Documentation</h3><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:0rem" href="/docs/forge/readme">README</a></li><li><a class="doc-link " style="padding-left:0rem" href="/docs/forge/index">index</a></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">cc65</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/cc65">README</a></li></ul></div></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">about</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/about/attributions">attributions</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/about/why-forge">why-forge</a></li></ul></div></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">advanced topics</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/advanced-topics/cio-reference">cio-reference</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/advanced-topics/display-list-interrupts">display-list-interrupts</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/advanced-topics/fujinet">fujinet</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/advanced-topics/low-level-programming">low-level-programming</a></li><li><a class="doc-link active" style="padding-left:1.2rem" href="/docs/forge/advanced-topics/note-point">note-point</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/advanced-topics/sio-operations">sio-operations</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/advanced-topics/xio-reference">xio-reference</a></li></ul></div></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">getting started</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/getting-started/compiling">compiling</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/getting-started/differences">differences</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/getting-started/first-steps">first-steps</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/getting-started/introduction">introduction</a></li></ul></div></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">editor</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/editor/editor-guide">editor-guide</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/editor/editor-optimization">editor-optimization</a></li></ul></div></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">language reference</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/language-reference/expressions">expressions</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/language-reference/functions">functions</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/language-reference/statements">statements</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/language-reference/syntax">syntax</a></li></ul></div></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">reference</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/hardware-registers">hardware-registers</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/interrupts">interrupts</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/iocb-structure">iocb-structure</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/memory-map">memory-map</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/memory-usage">memory-usage</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/os-equates">os-equates</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/r-handler">r-handler</a></li></ul></div></li></ul></div></nav></aside><div class="docs-content"><div class="docs-body"><div class="doc-markdown"><h1>NOTE and POINT</h1>
<p>The <code>NOTE</code> and <code>POINT</code> statements provide native random-access file positioning in FORGE, enabling indexed record retrieval and efficient file operations.</p>
<h2>Overview</h2>
<p><code>NOTE</code> and <code>POINT</code> allow you to:</p>
<ul>
<li>Write a file sequentially</li>
<li>Remember &quot;where you are&quot; (sector + byte)</li>
<li>Later jump back to an exact spot for indexed retrieval</li>
</ul>
<p>This is the classic Atari BASIC method for:</p>
<ul>
<li>Mailing list databases (records)</li>
<li>User/password/email databases</li>
<li>Message bases (BBS)</li>
<li>Fast &quot;index files&quot; (record pointers)</li>
</ul>
<h2>Syntax</h2>
<h3>NOTE #<em>iochn</em>, <em>sectVar</em>, <em>byteVar</em> / NO.</h3>
<p><strong>Get Current File Position</strong></p>
<p>Gets the current file position for channel <em>iochn</em> and stores the sector number (16-bit) into <em>sectVar</em> and the byte offset within the sector (8-bit) into <em>byteVar</em>.</p>
<ul>
<li><code>#_iochn_</code> - IOCB channel number (like <code>#1</code>)</li>
<li><code>_sectVar_</code> - 16-bit integer destination (sector, 0-65535)</li>
<li><code>_byteVar_</code> - 8-bit integer destination (byte offset, 0-255)</li>
</ul>
<p><strong>Example:</strong></p>
<pre><pre class="language-basic"><code class="language-basic">NOTE #1, SEC, BYT
</code></pre></pre>
<h3>POINT #<em>iochn</em>, <em>sectExpr</em>, <em>byteExpr</em> / PO.</h3>
<p><strong>Set File Position</strong></p>
<p>Sets the file position for channel <em>iochn</em> to the specified sector <em>sectExpr</em> (16-bit) and byte offset <em>byteExpr</em> (8-bit) within that sector.</p>
<ul>
<li><code>#_iochn_</code> - IOCB channel number</li>
<li><code>_sectExpr_</code> - Sector number expression (0-65535)</li>
<li><code>_byteExpr_</code> - Byte offset expression (0-255)</li>
</ul>
<p><strong>Example:</strong></p>
<pre><pre class="language-basic"><code class="language-basic">POINT #1, SEC, BYT
</code></pre></pre>
<h2>Semantics</h2>
<h3>NOTE Behavior</h3>
<p><code>NOTE</code> captures the <strong>current logical file position</strong> for that channel.</p>
<ul>
<li>The returned <code>(sector, byte)</code> represents where the <em>next</em> read/write will occur.</li>
<li>After <code>INPUT #1, A$</code>, <code>NOTE</code> would report the position <em>after that line</em>.</li>
</ul>
<h3>POINT Behavior</h3>
<p><code>POINT</code> moves the channel to the requested file position:</p>
<ul>
<li>The <em>next</em> read/write starts from that spot</li>
<li>This enables <strong>indexed / random access reads</strong></li>
</ul>
<h2>Device Support</h2>
<h3>Works With</h3>
<ul>
<li><code>&quot;D:&quot;</code> disk files (DOS/CIO handlers that implement NOTE/POINT)</li>
<li>Most normal filesystem-backed handlers</li>
</ul>
<h3>Undefined / Error-Prone On</h3>
<ul>
<li>Screen/editor devices (<code>&quot;E:&quot;</code>, <code>&quot;K:&quot;</code>)</li>
<li>Devices that don&#x27;t implement seek (depends on handler)</li>
</ul>
<p><strong>Rule:</strong> If the handler can&#x27;t do it, <code>ERR()</code> will report a CIO error.</p>
<h2>Types and Ranges</h2>
<p>FORGE uses 16-bit integers by default, so:</p>
<ul>
<li><code>sectVar</code>: <code>0..65535</code> (WORD)</li>
<li><code>byteVar</code>: <code>0..255</code> (BYTE, but stored as integer)</li>
</ul>
<p>Typical DOS-style use is <code>byteVar</code> in the <strong>0..127</strong> range (128-byte sectors), but the compiler should not enforce that — let the handler decide.</p>
<h2>Error Handling</h2>
<p>If <code>NOTE</code> or <code>POINT</code> fails, it behaves like other CIO calls:</p>
<ul>
<li><code>ERR()</code> is set to the CIO status code</li>
<li>Caller can check like:</li>
</ul>
<pre><pre class="language-basic"><code class="language-basic">NOTE #1, S, B
IF ERR() &lt;&gt; 1 THEN ? &quot;NOTE failed: &quot;; ERR()
</code></pre></pre>
<p><strong>Common failure reasons:</strong></p>
<ul>
<li>Channel not open</li>
<li>Device doesn&#x27;t support NOTE/POINT</li>
<li>Invalid position (POINT out of range)</li>
</ul>
<h2>AUX1 Preservation</h2>
<p><strong>Built-in behavior requirement:</strong></p>
<p>✅ <code>NOTE</code> and <code>POINT</code> must internally use the <em>same AUX1 mode used when OPEN was performed</em><br/>
<!-- -->✅ No user-visible <code>AUX1</code> parameter<br/>
<!-- -->✅ No &quot;4 vs 8 mismatch&quot; bugs</p>
<p>This automatic AUX1 preservation makes <code>NOTE</code>/<code>POINT</code> safer than manual XIO calls.</p>
<h2>Examples</h2>
<h3>Example 1: Indexed Record Retrieval</h3>
<p><strong>Write a file and build a pointer index in RAM:</strong></p>
<pre><pre class="language-basic"><code class="language-basic">DIM SEC(200), BYT(200)
N=0

OPEN #1,8,0,&quot;D:USERS.DAT&quot;

FOR I=1 TO 10
  &#x27; save the position where this record starts
  NOTE #1, SEC(N), BYT(N)
  
  PRINT #1,&quot;user&quot;;I;&quot;,pass&quot;;I;&quot;,email&quot;;I;&quot;@site.com&quot;
  N=N+1
NEXT I

CLOSE #1
? &quot;Wrote &quot;;N;&quot; records.&quot;
</code></pre></pre>
<p><strong>Later: open and jump directly to record #5:</strong></p>
<pre><pre class="language-basic"><code class="language-basic">OPEN #1,4,0,&quot;D:USERS.DAT&quot;

REC=5
POINT #1, SEC(REC), BYT(REC)
INPUT #1,A$
? &quot;Record &quot;;REC;&quot;: &quot;;A$

CLOSE #1
</code></pre></pre>
<p>This is <strong>exactly</strong> how you build:</p>
<ul>
<li>User DB lookups</li>
<li>Message retrieval by record number</li>
<li>Indexed reads without scanning the whole file</li>
</ul>
<h3>Example 2: BBS Message Base</h3>
<p>Append-only message bases are perfect for NOTE/POINT because old pointers never move.</p>
<p><strong>Writing messages:</strong></p>
<pre><pre class="language-basic"><code class="language-basic">DIM MSGSEC(500), MSGBYT(500)
MSGCNT=0

OPEN #1,8,0,&quot;D:MSGS.TXT&quot;

&#x27; Store where message starts
NOTE #1, MSGSEC(MSGCNT), MSGBYT(MSGCNT)

PRINT #1,&quot;[MSG #&quot;;MSGCNT;&quot;] Hello world!&quot;
MSGCNT=MSGCNT+1

CLOSE #1
</code></pre></pre>
<p><strong>Reading back message #0 later:</strong></p>
<pre><pre class="language-basic"><code class="language-basic">OPEN #1,4,0,&quot;D:MSGS.TXT&quot;
POINT #1, MSGSEC(0), MSGBYT(0)
INPUT #1,A$
? A$
CLOSE #1
</code></pre></pre>
<h3>Example 3: Building an Index File</h3>
<pre><pre class="language-basic"><code class="language-basic">&#x27; Write data file and index
DIM INDEX_SEC(1000), INDEX_BYT(1000)
REC_COUNT = 0

OPEN #1, 8, 0, &quot;D:DATA.TXT&quot;
OPEN #2, 8, 0, &quot;D:INDEX.DAT&quot;

FOR I = 1 TO 100
  &#x27; Save position before writing record
  NOTE #1, INDEX_SEC(REC_COUNT), INDEX_BYT(REC_COUNT)
  
  &#x27; Write record
  PRINT #1, &quot;Record &quot;; I; &quot; data here&quot;
  
  &#x27; Save index entry
  PRINT #2, INDEX_SEC(REC_COUNT), INDEX_BYT(REC_COUNT)
  
  REC_COUNT = REC_COUNT + 1
NEXT I

CLOSE #1
CLOSE #2
</code></pre></pre>
<p><strong>Using the index:</strong></p>
<pre><pre class="language-basic"><code class="language-basic">&#x27; Read index
DIM INDEX_SEC(1000), INDEX_BYT(1000)
REC_COUNT = 0

OPEN #2, 4, 0, &quot;D:INDEX.DAT&quot;
REPEAT
  INPUT #2, INDEX_SEC(REC_COUNT), INDEX_BYT(REC_COUNT)
  REC_COUNT = REC_COUNT + 1
UNTIL ERR() &lt;&gt; 1
CLOSE #2

&#x27; Read specific record
OPEN #1, 4, 0, &quot;D:DATA.TXT&quot;
REC_NUM = 42
POINT #1, INDEX_SEC(REC_NUM), INDEX_BYT(REC_NUM)
INPUT #1, RECORD$
? &quot;Record &quot;; REC_NUM; &quot;: &quot;; RECORD$
CLOSE #1
</code></pre></pre>
<h2>Best Practices</h2>
<ol>
<li><strong>Save positions before writing</strong> - Use <code>NOTE</code> before each record write</li>
<li><strong>Store indexes in arrays</strong> - Keep sector/byte pairs in memory for fast access</li>
<li><strong>Validate positions</strong> - Check <code>ERR()</code> after <code>NOTE</code> and <code>POINT</code></li>
<li><strong>Use consistent file modes</strong> - Open files the same way when reading/writing</li>
<li><strong>Handle errors gracefully</strong> - Some devices don&#x27;t support NOTE/POINT</li>
</ol>
<h2>Troubleshooting</h2>
<p><strong>NOTE/POINT fails:</strong></p>
<ul>
<li>Check channel is open</li>
<li>Verify device supports NOTE/POINT</li>
<li>Check <code>ERR()</code> for specific error code</li>
</ul>
<p><strong>Wrong position returned:</strong></p>
<ul>
<li>Ensure file was opened with correct mode</li>
<li>Check for file modifications between NOTE and POINT</li>
<li>Verify sector/byte values are correct</li>
</ul>
<p><strong>Data corruption:</strong></p>
<ul>
<li>Don&#x27;t modify file between NOTE and POINT</li>
<li>Ensure file is closed properly</li>
<li>Check for concurrent access</li>
</ul>
<h2>Related Topics</h2>
<ul>
<li><a node="[object Object]" href="/docs/forge/advanced-topics/language-reference/statements">Statements</a> - Complete statement reference</li>
<li><a node="[object Object]" href="/docs/forge/cio-reference">CIO Reference</a> - Central I/O operations</li>
<li><a node="[object Object]" href="/docs/forge/xio-reference">XIO Reference</a> - Extended I/O commands</li>
<li><a node="[object Object]" href="/language-reference/statements.md#device-input-and-output-statements">Device I/O</a> - File operations</li>
</ul></div></div></div></div></main><footer class="footer"><p>© 2026 Atari Foundry · Rick Collette · Software for Atari 8-bit builders.</p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"product":"forge","productDocs":{"product":"forge","files":[{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/cc65/README.md","relativePath":"cc65/README.md","relativeDir":"cc65","filename":"README","slug":"readme","name":"README"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/README.md","relativePath":"README.md","relativeDir":"","filename":"README","slug":"readme","name":"README"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/about/attributions.md","relativePath":"about/attributions.md","relativeDir":"about","filename":"attributions","slug":"attributions","name":"attributions"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/cio-reference.md","relativePath":"advanced-topics/cio-reference.md","relativeDir":"advanced-topics","filename":"cio-reference","slug":"cio-reference","name":"cio-reference"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/compiling.md","relativePath":"getting-started/compiling.md","relativeDir":"getting-started","filename":"compiling","slug":"compiling","name":"compiling"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/differences.md","relativePath":"getting-started/differences.md","relativeDir":"getting-started","filename":"differences","slug":"differences","name":"differences"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/display-list-interrupts.md","relativePath":"advanced-topics/display-list-interrupts.md","relativeDir":"advanced-topics","filename":"display-list-interrupts","slug":"display-list-interrupts","name":"display-list-interrupts"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/editor/editor-guide.md","relativePath":"editor/editor-guide.md","relativeDir":"editor","filename":"editor-guide","slug":"editor-guide","name":"editor-guide"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/editor/editor-optimization.md","relativePath":"editor/editor-optimization.md","relativeDir":"editor","filename":"editor-optimization","slug":"editor-optimization","name":"editor-optimization"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/expressions.md","relativePath":"language-reference/expressions.md","relativeDir":"language-reference","filename":"expressions","slug":"expressions","name":"expressions"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/first-steps.md","relativePath":"getting-started/first-steps.md","relativeDir":"getting-started","filename":"first-steps","slug":"first-steps","name":"first-steps"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/fujinet.md","relativePath":"advanced-topics/fujinet.md","relativeDir":"advanced-topics","filename":"fujinet","slug":"fujinet","name":"fujinet"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/functions.md","relativePath":"language-reference/functions.md","relativeDir":"language-reference","filename":"functions","slug":"functions","name":"functions"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/hardware-registers.md","relativePath":"reference/hardware-registers.md","relativeDir":"reference","filename":"hardware-registers","slug":"hardware-registers","name":"hardware-registers"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/index.md","relativePath":"index.md","relativeDir":"","filename":"index","slug":"index","name":"index"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/interrupts.md","relativePath":"reference/interrupts.md","relativeDir":"reference","filename":"interrupts","slug":"interrupts","name":"interrupts"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/introduction.md","relativePath":"getting-started/introduction.md","relativeDir":"getting-started","filename":"introduction","slug":"introduction","name":"introduction"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/iocb-structure.md","relativePath":"reference/iocb-structure.md","relativeDir":"reference","filename":"iocb-structure","slug":"iocb-structure","name":"iocb-structure"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/low-level-programming.md","relativePath":"advanced-topics/low-level-programming.md","relativeDir":"advanced-topics","filename":"low-level-programming","slug":"low-level-programming","name":"low-level-programming"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/memory-map.md","relativePath":"reference/memory-map.md","relativeDir":"reference","filename":"memory-map","slug":"memory-map","name":"memory-map"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/memory-usage.md","relativePath":"reference/memory-usage.md","relativeDir":"reference","filename":"memory-usage","slug":"memory-usage","name":"memory-usage"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/note-point.md","relativePath":"advanced-topics/note-point.md","relativeDir":"advanced-topics","filename":"note-point","slug":"note-point","name":"note-point"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/os-equates.md","relativePath":"reference/os-equates.md","relativeDir":"reference","filename":"os-equates","slug":"os-equates","name":"os-equates"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/r-handler.md","relativePath":"reference/r-handler.md","relativeDir":"reference","filename":"r-handler","slug":"r-handler","name":"r-handler"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/sio-operations.md","relativePath":"advanced-topics/sio-operations.md","relativeDir":"advanced-topics","filename":"sio-operations","slug":"sio-operations","name":"sio-operations"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/statements.md","relativePath":"language-reference/statements.md","relativeDir":"language-reference","filename":"statements","slug":"statements","name":"statements"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/syntax.md","relativePath":"language-reference/syntax.md","relativeDir":"language-reference","filename":"syntax","slug":"syntax","name":"syntax"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/about/why-forge.md","relativePath":"about/why-forge.md","relativeDir":"about","filename":"why-forge","slug":"why-forge","name":"why-forge"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/xio-reference.md","relativePath":"advanced-topics/xio-reference.md","relativeDir":"advanced-topics","filename":"xio-reference","slug":"xio-reference","name":"xio-reference"}],"navTree":{"cc65":{"_files":[{"name":"README","slug":"readme","path":"cc65/README.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/cc65/README.md","isIndex":true}]},"_files":[{"name":"README","slug":"readme","path":"README.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/README.md","isIndex":true},{"name":"index","slug":"index","path":"index.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/index.md","isIndex":false}],"about":{"_files":[{"name":"attributions","slug":"attributions","path":"about/attributions.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/about/attributions.md","isIndex":false},{"name":"why-forge","slug":"why-forge","path":"about/why-forge.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/about/why-forge.md","isIndex":false}]},"advanced-topics":{"_files":[{"name":"cio-reference","slug":"cio-reference","path":"advanced-topics/cio-reference.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/cio-reference.md","isIndex":false},{"name":"display-list-interrupts","slug":"display-list-interrupts","path":"advanced-topics/display-list-interrupts.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/display-list-interrupts.md","isIndex":false},{"name":"fujinet","slug":"fujinet","path":"advanced-topics/fujinet.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/fujinet.md","isIndex":false},{"name":"low-level-programming","slug":"low-level-programming","path":"advanced-topics/low-level-programming.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/low-level-programming.md","isIndex":false},{"name":"note-point","slug":"note-point","path":"advanced-topics/note-point.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/note-point.md","isIndex":false},{"name":"sio-operations","slug":"sio-operations","path":"advanced-topics/sio-operations.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/sio-operations.md","isIndex":false},{"name":"xio-reference","slug":"xio-reference","path":"advanced-topics/xio-reference.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/xio-reference.md","isIndex":false}]},"getting-started":{"_files":[{"name":"compiling","slug":"compiling","path":"getting-started/compiling.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/compiling.md","isIndex":false},{"name":"differences","slug":"differences","path":"getting-started/differences.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/differences.md","isIndex":false},{"name":"first-steps","slug":"first-steps","path":"getting-started/first-steps.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/first-steps.md","isIndex":false},{"name":"introduction","slug":"introduction","path":"getting-started/introduction.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/introduction.md","isIndex":false}]},"editor":{"_files":[{"name":"editor-guide","slug":"editor-guide","path":"editor/editor-guide.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/editor/editor-guide.md","isIndex":false},{"name":"editor-optimization","slug":"editor-optimization","path":"editor/editor-optimization.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/editor/editor-optimization.md","isIndex":false}]},"language-reference":{"_files":[{"name":"expressions","slug":"expressions","path":"language-reference/expressions.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/expressions.md","isIndex":false},{"name":"functions","slug":"functions","path":"language-reference/functions.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/functions.md","isIndex":false},{"name":"statements","slug":"statements","path":"language-reference/statements.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/statements.md","isIndex":false},{"name":"syntax","slug":"syntax","path":"language-reference/syntax.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/syntax.md","isIndex":false}]},"reference":{"_files":[{"name":"hardware-registers","slug":"hardware-registers","path":"reference/hardware-registers.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/hardware-registers.md","isIndex":false},{"name":"interrupts","slug":"interrupts","path":"reference/interrupts.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/interrupts.md","isIndex":false},{"name":"iocb-structure","slug":"iocb-structure","path":"reference/iocb-structure.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/iocb-structure.md","isIndex":false},{"name":"memory-map","slug":"memory-map","path":"reference/memory-map.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/memory-map.md","isIndex":false},{"name":"memory-usage","slug":"memory-usage","path":"reference/memory-usage.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/memory-usage.md","isIndex":false},{"name":"os-equates","slug":"os-equates","path":"reference/os-equates.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/os-equates.md","isIndex":false},{"name":"r-handler","slug":"r-handler","path":"reference/r-handler.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/r-handler.md","isIndex":false}]}}},"docFile":{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/note-point.md","relativePath":"advanced-topics/note-point.md","relativeDir":"advanced-topics","filename":"note-point","slug":"note-point","name":"note-point","content":"# NOTE and POINT\n\nThe `NOTE` and `POINT` statements provide native random-access file positioning in FORGE, enabling indexed record retrieval and efficient file operations.\n\n## Overview\n\n`NOTE` and `POINT` allow you to:\n\n- Write a file sequentially\n- Remember \"where you are\" (sector + byte)\n- Later jump back to an exact spot for indexed retrieval\n\nThis is the classic Atari BASIC method for:\n- Mailing list databases (records)\n- User/password/email databases\n- Message bases (BBS)\n- Fast \"index files\" (record pointers)\n\n## Syntax\n\n### NOTE #_iochn_, _sectVar_, _byteVar_ / NO.\n\n**Get Current File Position**\n\nGets the current file position for channel _iochn_ and stores the sector number (16-bit) into _sectVar_ and the byte offset within the sector (8-bit) into _byteVar_.\n\n- `#_iochn_` - IOCB channel number (like `#1`)\n- `_sectVar_` - 16-bit integer destination (sector, 0-65535)\n- `_byteVar_` - 8-bit integer destination (byte offset, 0-255)\n\n**Example:**\n```basic\nNOTE #1, SEC, BYT\n```\n\n### POINT #_iochn_, _sectExpr_, _byteExpr_ / PO.\n\n**Set File Position**\n\nSets the file position for channel _iochn_ to the specified sector _sectExpr_ (16-bit) and byte offset _byteExpr_ (8-bit) within that sector.\n\n- `#_iochn_` - IOCB channel number\n- `_sectExpr_` - Sector number expression (0-65535)\n- `_byteExpr_` - Byte offset expression (0-255)\n\n**Example:**\n```basic\nPOINT #1, SEC, BYT\n```\n\n## Semantics\n\n### NOTE Behavior\n\n`NOTE` captures the **current logical file position** for that channel.\n\n- The returned `(sector, byte)` represents where the *next* read/write will occur.\n- After `INPUT #1, A$`, `NOTE` would report the position *after that line*.\n\n### POINT Behavior\n\n`POINT` moves the channel to the requested file position:\n\n- The *next* read/write starts from that spot\n- This enables **indexed / random access reads**\n\n## Device Support\n\n### Works With\n\n- `\"D:\"` disk files (DOS/CIO handlers that implement NOTE/POINT)\n- Most normal filesystem-backed handlers\n\n### Undefined / Error-Prone On\n\n- Screen/editor devices (`\"E:\"`, `\"K:\"`)\n- Devices that don't implement seek (depends on handler)\n\n**Rule:** If the handler can't do it, `ERR()` will report a CIO error.\n\n## Types and Ranges\n\nFORGE uses 16-bit integers by default, so:\n\n- `sectVar`: `0..65535` (WORD)\n- `byteVar`: `0..255` (BYTE, but stored as integer)\n\nTypical DOS-style use is `byteVar` in the **0..127** range (128-byte sectors), but the compiler should not enforce that — let the handler decide.\n\n## Error Handling\n\nIf `NOTE` or `POINT` fails, it behaves like other CIO calls:\n\n- `ERR()` is set to the CIO status code\n- Caller can check like:\n\n```basic\nNOTE #1, S, B\nIF ERR() \u003c\u003e 1 THEN ? \"NOTE failed: \"; ERR()\n```\n\n**Common failure reasons:**\n- Channel not open\n- Device doesn't support NOTE/POINT\n- Invalid position (POINT out of range)\n\n## AUX1 Preservation\n\n**Built-in behavior requirement:**\n\n✅ `NOTE` and `POINT` must internally use the *same AUX1 mode used when OPEN was performed*  \n✅ No user-visible `AUX1` parameter  \n✅ No \"4 vs 8 mismatch\" bugs\n\nThis automatic AUX1 preservation makes `NOTE`/`POINT` safer than manual XIO calls.\n\n## Examples\n\n### Example 1: Indexed Record Retrieval\n\n**Write a file and build a pointer index in RAM:**\n\n```basic\nDIM SEC(200), BYT(200)\nN=0\n\nOPEN #1,8,0,\"D:USERS.DAT\"\n\nFOR I=1 TO 10\n  ' save the position where this record starts\n  NOTE #1, SEC(N), BYT(N)\n  \n  PRINT #1,\"user\";I;\",pass\";I;\",email\";I;\"@site.com\"\n  N=N+1\nNEXT I\n\nCLOSE #1\n? \"Wrote \";N;\" records.\"\n```\n\n**Later: open and jump directly to record #5:**\n\n```basic\nOPEN #1,4,0,\"D:USERS.DAT\"\n\nREC=5\nPOINT #1, SEC(REC), BYT(REC)\nINPUT #1,A$\n? \"Record \";REC;\": \";A$\n\nCLOSE #1\n```\n\nThis is **exactly** how you build:\n- User DB lookups\n- Message retrieval by record number\n- Indexed reads without scanning the whole file\n\n### Example 2: BBS Message Base\n\nAppend-only message bases are perfect for NOTE/POINT because old pointers never move.\n\n**Writing messages:**\n\n```basic\nDIM MSGSEC(500), MSGBYT(500)\nMSGCNT=0\n\nOPEN #1,8,0,\"D:MSGS.TXT\"\n\n' Store where message starts\nNOTE #1, MSGSEC(MSGCNT), MSGBYT(MSGCNT)\n\nPRINT #1,\"[MSG #\";MSGCNT;\"] Hello world!\"\nMSGCNT=MSGCNT+1\n\nCLOSE #1\n```\n\n**Reading back message #0 later:**\n\n```basic\nOPEN #1,4,0,\"D:MSGS.TXT\"\nPOINT #1, MSGSEC(0), MSGBYT(0)\nINPUT #1,A$\n? A$\nCLOSE #1\n```\n\n### Example 3: Building an Index File\n\n```basic\n' Write data file and index\nDIM INDEX_SEC(1000), INDEX_BYT(1000)\nREC_COUNT = 0\n\nOPEN #1, 8, 0, \"D:DATA.TXT\"\nOPEN #2, 8, 0, \"D:INDEX.DAT\"\n\nFOR I = 1 TO 100\n  ' Save position before writing record\n  NOTE #1, INDEX_SEC(REC_COUNT), INDEX_BYT(REC_COUNT)\n  \n  ' Write record\n  PRINT #1, \"Record \"; I; \" data here\"\n  \n  ' Save index entry\n  PRINT #2, INDEX_SEC(REC_COUNT), INDEX_BYT(REC_COUNT)\n  \n  REC_COUNT = REC_COUNT + 1\nNEXT I\n\nCLOSE #1\nCLOSE #2\n```\n\n**Using the index:**\n\n```basic\n' Read index\nDIM INDEX_SEC(1000), INDEX_BYT(1000)\nREC_COUNT = 0\n\nOPEN #2, 4, 0, \"D:INDEX.DAT\"\nREPEAT\n  INPUT #2, INDEX_SEC(REC_COUNT), INDEX_BYT(REC_COUNT)\n  REC_COUNT = REC_COUNT + 1\nUNTIL ERR() \u003c\u003e 1\nCLOSE #2\n\n' Read specific record\nOPEN #1, 4, 0, \"D:DATA.TXT\"\nREC_NUM = 42\nPOINT #1, INDEX_SEC(REC_NUM), INDEX_BYT(REC_NUM)\nINPUT #1, RECORD$\n? \"Record \"; REC_NUM; \": \"; RECORD$\nCLOSE #1\n```\n\n## Best Practices\n\n1. **Save positions before writing** - Use `NOTE` before each record write\n2. **Store indexes in arrays** - Keep sector/byte pairs in memory for fast access\n3. **Validate positions** - Check `ERR()` after `NOTE` and `POINT`\n4. **Use consistent file modes** - Open files the same way when reading/writing\n5. **Handle errors gracefully** - Some devices don't support NOTE/POINT\n\n## Troubleshooting\n\n**NOTE/POINT fails:**\n- Check channel is open\n- Verify device supports NOTE/POINT\n- Check `ERR()` for specific error code\n\n**Wrong position returned:**\n- Ensure file was opened with correct mode\n- Check for file modifications between NOTE and POINT\n- Verify sector/byte values are correct\n\n**Data corruption:**\n- Don't modify file between NOTE and POINT\n- Ensure file is closed properly\n- Check for concurrent access\n\n## Related Topics\n\n- [Statements](../language-reference/statements.md) - Complete statement reference\n- [CIO Reference](cio-reference.md) - Central I/O operations\n- [XIO Reference](xio-reference.md) - Extended I/O commands\n- [Device I/O](../language-reference/statements.md#device-input-and-output-statements) - File operations\n"},"currentPath":"advanced-topics/note-point"},"__N_SSG":true},"page":"/docs/[...slug]","query":{"slug":["forge","advanced-topics","note-point"]},"buildId":"uKcVMkypfjITnNYGcdC5l","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>