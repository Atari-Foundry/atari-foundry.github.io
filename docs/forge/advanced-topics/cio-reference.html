<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><title data-next-head="">cio-reference | forge Documentation | Atari Foundry</title><meta name="description" content="forge documentation: cio-reference" data-next-head=""/><link rel="preload" href="/images/foundry_logo_50H.png" as="image" data-next-head=""/><link rel="preload" href="/_next/static/chunks/c81f129e50a5fd79.css" as="style"/><link rel="stylesheet" href="/_next/static/chunks/c81f129e50a5fd79.css" data-n-g=""/><noscript data-n-css=""></noscript><script src="/_next/static/chunks/e8a4a4ae55bc5744.js" defer=""></script><script src="/_next/static/chunks/00dac80f236dcabb.js" defer=""></script><script src="/_next/static/chunks/44f6bc00d9aaf830.js" defer=""></script><script src="/_next/static/chunks/fd7cb30d70431a0f.js" defer=""></script><script src="/_next/static/chunks/turbopack-4769270d21ef6607.js" defer=""></script><script src="/_next/static/chunks/1b081b821847ed60.js" defer=""></script><script src="/_next/static/chunks/76d09b6b03e70f66.js" defer=""></script><script src="/_next/static/chunks/b56fd671c61106a7.js" defer=""></script><script src="/_next/static/chunks/turbopack-d90ce600b0329ce0.js" defer=""></script><script src="/_next/static/qaNXmQ4K6kOqdwj6jY2RG/_ssgManifest.js" defer=""></script><script src="/_next/static/qaNXmQ4K6kOqdwj6jY2RG/_buildManifest.js" defer=""></script></head><body><div id="__next"><div class="crt"><div class="scanlines" aria-hidden="true"></div><div class="noise" aria-hidden="true"></div><nav class="nav"><a class="nav-brand" href="/"><img alt="Atari Foundry icon" width="72" height="50" decoding="async" data-nimg="1" style="color:transparent;height:40px;width:auto" src="/images/foundry_logo_50H.png"/><div><span class="nav-brand-title">Atari Foundry</span><span class="nav-brand-sub">Products for Atari 8-bit</span></div></a><ul class="nav-links"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/vault">Vault</a></li><li class="nav-item has-children"><button type="button" class="nav-link nav-trigger active" aria-haspopup="true" aria-expanded="false">Docs</button><div class="nav-dropdown"><a class="nav-dropdown-link" href="/docs/crucible">Crucible</a><a class="nav-dropdown-link" href="/docs/atrforge">atrforge</a><a class="nav-dropdown-link" href="/docs/forge">FORGE</a></div></li><li class="nav-item"><a class="nav-link" href="/downloads">Downloads</a></li><li class="nav-item"><a class="nav-link" href="/support">Support</a></li></ul></nav><header class="subhero"><p class="label">forge<!-- --> Documentation</p><h1 class="page-title">cio-reference</h1></header><main><div class="docs-layout"><aside class="docs-sidebar"><nav class="docs-nav"><div class="docs-nav-section"><h3>Documentation</h3><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:0rem" href="/docs/forge/readme">README</a></li><li><a class="doc-link " style="padding-left:0rem" href="/docs/forge/index">index</a></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">cc65</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/cc65">README</a></li></ul></div></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">about</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/about/attributions">attributions</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/about/why-forge">why-forge</a></li></ul></div></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">advanced topics</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link active" style="padding-left:1.2rem" href="/docs/forge/advanced-topics/cio-reference">cio-reference</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/advanced-topics/display-list-interrupts">display-list-interrupts</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/advanced-topics/fujinet">fujinet</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/advanced-topics/low-level-programming">low-level-programming</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/advanced-topics/note-point">note-point</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/advanced-topics/sio-operations">sio-operations</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/advanced-topics/xio-reference">xio-reference</a></li></ul></div></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">getting started</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/getting-started/compiling">compiling</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/getting-started/differences">differences</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/getting-started/first-steps">first-steps</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/getting-started/introduction">introduction</a></li></ul></div></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">editor</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/editor/editor-guide">editor-guide</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/editor/editor-optimization">editor-optimization</a></li></ul></div></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">language reference</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/language-reference/expressions">expressions</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/language-reference/functions">functions</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/language-reference/statements">statements</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/language-reference/syntax">syntax</a></li></ul></div></li><li><div class="docs-nav-section" style="margin-top:0"><h4 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.15em;color:rgba(255, 255, 255, 0.5);margin-bottom:0.6rem;font-weight:700;padding-left:0rem">reference</h4><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/hardware-registers">hardware-registers</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/interrupts">interrupts</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/iocb-structure">iocb-structure</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/memory-map">memory-map</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/memory-usage">memory-usage</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/os-equates">os-equates</a></li><li><a class="doc-link " style="padding-left:1.2rem" href="/docs/forge/reference/r-handler">r-handler</a></li></ul></div></li></ul></div></nav></aside><div class="docs-content"><div class="docs-body"><div class="doc-markdown"><h1>CIO Reference</h1>
<p>The Central Input/Output Utility (CIO) is the primary I/O system used by the Atari 8-bit computers. Nearly all input or output passes through this utility.</p>
<h2>Overview</h2>
<p>CIO uses eight &quot;channels&quot; as paths for I/O. There are not really separate channels for I/O but the computer acts as if there were. Each channel is controlled by a 16 byte block of memory called an Input/Output Control Block or IOCB.</p>
<h2>CIO Channels</h2>
<p>There are eight CIO channels, numbered from 0 to 7. In BASIC some channels are reserved for BASIC&#x27;s use.</p>
<h3>BASIC CIO Channel Assignments</h3>
<table><thead><tr><th>Channel</th><th>Assignment</th></tr></thead><tbody><tr><td>0</td><td>Permanently assigned to the screen editor</td></tr><tr><td>6</td><td>Used for graphics commands</td></tr><tr><td>7</td><td>Used for the Cassette, disk and printer</td></tr></tbody></table>
<p>Channels 6 and 7 are free to use when they are not being used by BASIC. With machine language, all of the channels are available to the programmer.</p>
<h2>IOCB Structure</h2>
<p>The IOCB for channel zero starts at address $0340 (decimal 832). This is the only address you need to know. Indexing from this address is used to find all of the other bytes.</p>
<h3>IOCB Bytes and Uses</h3>
<table><thead><tr><th>Address</th><th>Name</th><th>Explanation</th></tr></thead><tbody><tr><td>$0340</td><td>ICHID</td><td>Handler Identifier</td></tr><tr><td>$0341</td><td>ICDNO</td><td>Device number (disk)</td></tr><tr><td>$0342</td><td>ICCOM</td><td>Command</td></tr><tr><td>$0343</td><td>ICSTA</td><td>Status</td></tr><tr><td>$0344</td><td>ICBAL</td><td>Buffer address (low byte)</td></tr><tr><td>$0345</td><td>ICBAH</td><td>Buffer address (high byte)</td></tr><tr><td>$0346</td><td>ICPTL</td><td>Address of put byte routine (used by BASIC)</td></tr><tr><td>$0347</td><td>ICPTH</td><td>Address of put byte routine (used by BASIC)</td></tr><tr><td>$0348</td><td>ICBLL</td><td>Buffer length (low byte)</td></tr><tr><td>$0349</td><td>ICBLH</td><td>Buffer length (high byte)</td></tr><tr><td>$034A</td><td>ICAX1</td><td>Auxiliary information</td></tr><tr><td>$034B</td><td>ICAX2</td><td>-</td></tr><tr><td>$034C</td><td>ICAX3</td><td>The remaining auxiliary bytes are rarely used</td></tr><tr><td>$034D</td><td>ICAX4</td><td>-</td></tr><tr><td>$034E</td><td>ICAX5</td><td>-</td></tr><tr><td>$034F</td><td>ICAX6</td><td>-</td></tr></tbody></table>
<h3>ICHID</h3>
<p>When a channel is open, the handler I.D. contains an index to the handler table. The handler table holds the address of the device handling routines. When the channel is closed ICHID contains $FF.</p>
<h3>ICDNO</h3>
<p>The device number is used to distinguish between multiple devices with the same name, such as disk drives.</p>
<h3>ICCOM</h3>
<p>The command byte tells CIO what operation to perform.</p>
<h3>ICSTA</h3>
<p>The status byte contains an error code if something goes wrong. If bit 7 is 0 there have been no errors.</p>
<h3>ICBAL and ICBAH</h3>
<p>Before a channel is opened, the buffer address bytes are set point to the block of memory which contains the name of the device the channel is to be opened to. Before actual input or output these bytes are set to point to the block of memory where the I/O data is stored or is to be stored.</p>
<h3>ICBLL and ICBLH</h3>
<p>The buffer length bytes show the number of bytes in the block of memory used to store the input or output data. If the amount of data read during an input operation is less than the length of the buffer, the number of bytes actually read will be put in ICBLL and ICBLH by CIO.</p>
<h3>ICAX1 through ICAX6</h3>
<p>The auxiliary information bytes are used to give CIO or the device any special information needed.</p>
<h2>CIO Command Codes</h2>
<table><thead><tr><th>Hex</th><th>Dec</th><th>Command</th><th>Notes</th></tr></thead><tbody><tr><td>$03</td><td>3</td><td>Open</td><td>May be made to a closed channel</td></tr><tr><td>$05</td><td>5</td><td>Get Record</td><td>-</td></tr><tr><td>$07</td><td>7</td><td>Get</td><td>-</td></tr><tr><td>$09</td><td>9</td><td>Print</td><td>-</td></tr><tr><td>$0B</td><td>11</td><td>Put</td><td>-</td></tr><tr><td>$0C</td><td>12</td><td>Close</td><td>May be made to a closed channel</td></tr><tr><td>$0D</td><td>13</td><td>Status</td><td>May be made to a closed channel</td></tr><tr><td>&gt;$0D</td><td>&gt;13</td><td>Special</td><td>Device specific commands</td></tr></tbody></table>
<h2>Opening a CIO Channel</h2>
<p>Before using a CIO channel it must be assigned to an I/O device.</p>
<h3>Channel-Open Parameters</h3>
<ul>
<li><strong>ICCOM</strong> - open code ($03)</li>
<li><strong>ICBAL</strong> - address of device name in memory (low byte)</li>
<li><strong>ICBAH</strong> - address of device name in memory (high byte)</li>
<li><strong>ICAX1</strong> - direction code</li>
<li><strong>ICAX2</strong> - zero</li>
</ul>
<h3>Direction Codes (ICAX1)</h3>
<table><thead><tr><th>Hex</th><th>Dec</th><th>Operation</th></tr></thead><tbody><tr><td>$04</td><td>4</td><td>Input</td></tr><tr><td>$08</td><td>8</td><td>Output</td></tr><tr><td>$0C</td><td>12</td><td>Input and output (cannot change the length of a disk file)</td></tr></tbody></table>
<p><strong>ICAX1 format for opening a channel:</strong></p>
<pre><code>7 6 5 4 3 2 1 0
----------------
|        W R    |
----------------
        8 4 2 1
</code></pre>
<ul>
<li>W = 1 = open for output (write)</li>
<li>R = 1 = open for input (read)</li>
</ul>
<h3>Device Names</h3>
<p>ICBAL and ICBAH point to the device name stored in memory. The device and file name must be followed by 0 or $9B (decimal 155).</p>
<p><strong>CIO device names:</strong></p>
<table><thead><tr><th>Device</th><th>Description</th></tr></thead><tbody><tr><td>C</td><td>Cassette recorder</td></tr><tr><td>D</td><td>Disk drive (uses non-resident handler)</td></tr><tr><td>E</td><td>Screen editor</td></tr><tr><td>K</td><td>Keyboard</td></tr><tr><td>P</td><td>Printer</td></tr><tr><td>R</td><td>RS-232 I/O port (uses non-resident handler)</td></tr><tr><td>S</td><td>Screen handler</td></tr></tbody></table>
<p>The device name must usually be followed by a colon. With the disk drive a file name is expected after the device name.</p>
<h2>Using an Open Channel</h2>
<h3>INPUT (ICCOM = $05)</h3>
<p>The computer reads data from the device until a carriage-return is read (decimal number 155, hex $9B) or the end of the file (EOF) is reached.</p>
<p><strong>IOCB input parameters:</strong></p>
<ul>
<li>ICCOM - get record code ($05)</li>
<li>ICBAL - address of buffer to store the data in (low byte)</li>
<li>ICBAH - address of buffer to store the data in (high byte)</li>
<li>ICBLL - length of the data buffer (low byte)</li>
<li>ICBLH - length of the data buffer (high byte)</li>
</ul>
<p>If the data retrieved is shorter than the prepared buffer, the number of bytes actually read will be put into ICBLL and ICBLH.</p>
<h3>PRINT (ICCOM = $09)</h3>
<p>In assembly language the print command is identical to the input command. The only difference is that the PUTREC code ($09) is stored in ICCOM. The buffer bytes of the IOCB then specify the block of memory to be output from rather than input to. With the print command, EOLs within the string or buffer are ignored but an EOL is placed at the end of the data when sent to the device.</p>
<h3>GET (ICCOM = $07)</h3>
<p>In BASIC this command inputs a single byte of data from the device. EOLs are ignored.</p>
<p><strong>IOCB get-byte parameters:</strong></p>
<ul>
<li>ICCOM - get-character (single byte) code ($07)</li>
<li>ICBAL, ICBAH, ICBLL, ICBLH - same as in input</li>
</ul>
<h3>PUT (ICCOM = $0B)</h3>
<p>In BASIC, PUT is the opposite of GET. It outputs a single byte from a variable to the device.</p>
<p>In assembly language, the command byte of the IOCB is loaded with the put-character code (PUTCHR = $0B). Otherwise the PUT command is identical to GET.</p>
<h2>Closing a Channel</h2>
<p>Closing a channel frees it for use by another device or for changing parameters.</p>
<p><strong>IOCB close command:</strong></p>
<ul>
<li>ICCOM - close code ($0C)</li>
</ul>
<p>With the disk drive, the file name is not put into the directory until the channel is closed.</p>
<h2>Status Codes</h2>
<p>ICSTA (IOCB status byte) is the result code from the last CIO operation done on that IOCB.</p>
<p><strong>Location:</strong> 851 decimal = $0353 (for IOCB1)</p>
<p><strong>Meaning:</strong></p>
<ul>
<li>0 = success</li>
<li>Anything else = some kind of error or special condition</li>
</ul>
<h3>Common Status Values</h3>
<p><strong>Success:</strong></p>
<ul>
<li>0 = OK / Success</li>
</ul>
<p><strong>Non-fatal / end-of-data:</strong></p>
<ul>
<li>136 ($88) = End of File (EOF)</li>
<li>137 ($89) = Truncated record / line too long</li>
</ul>
<p><strong>Fatal errors (128-255):</strong></p>
<ul>
<li>Bad IOCB / channel not open</li>
<li>Device/handler not found</li>
<li>Bad command</li>
<li>Invalid parameter</li>
<li>Timeout</li>
<li>Device NAK / not responding</li>
<li>Framing / overrun errors (serial)</li>
</ul>
<h3>Interpreting ICSTA</h3>
<p><strong>Simple check:</strong></p>
<pre><pre class="language-basic"><code class="language-basic">S = PEEK(851)
IF S = 0 THEN ? &quot;OK&quot; ELSE ? &quot;ERROR/STATUS=&quot;; S
</code></pre></pre>
<p><strong>With EOF handling:</strong></p>
<pre><pre class="language-basic"><code class="language-basic">S = PEEK(851)
IF S = 0 THEN ? &quot;OK&quot;
IF S = 136 THEN ? &quot;EOF&quot;
IF S &gt; 127 AND S &lt;&gt; 136 THEN ? &quot;ERROR=&quot;; S
</code></pre></pre>
<h2>Device Table</h2>
<p>CIO uses a jump table located at $031A (794). When a CIO call is made, CIO searches the table for the one-byte device name. The two bytes following the device name contain the address of the device handler&#x27;s vector table. CIO searches the device table from the end, $033D (829) to the beginning.</p>
<h2>Handler Vector Table</h2>
<p>Each handler has its own vector table. This vector table is 16 bytes long. The two-byte vectors point to the various handler routines.</p>
<p><strong>Handler vector table order:</strong></p>
<ol>
<li>open</li>
<li>close</li>
<li>get byte</li>
<li>put byte</li>
<li>get stat</li>
<li>special</li>
<li>JMP init code (3 bytes)</li>
</ol>
<h2>Important Addresses</h2>
<table><thead><tr><th>Name</th><th>Address</th><th>Description</th></tr></thead><tbody><tr><td>DOSINI</td><td>$000C,2</td><td>Initialization vector</td></tr><tr><td>BRKKEY</td><td>$0011</td><td>Break key flag</td></tr><tr><td>ICHID</td><td>$0340</td><td>Start of IOCBs</td></tr><tr><td>HATABS</td><td>$031A,16</td><td>Device handler table</td></tr><tr><td>CIOV</td><td>$E456</td><td>CIO entry vector</td></tr></tbody></table>
<h2>FORGE Usage</h2>
<p>In FORGE, you typically use high-level statements that call CIO internally:</p>
<ul>
<li><code>OPEN #channel, mode, aux, &quot;device&quot;</code></li>
<li><code>INPUT #channel, variable</code></li>
<li><code>PRINT #channel, data</code></li>
<li><code>GET #channel, variable</code></li>
<li><code>PUT #channel, value</code></li>
<li><code>CLOSE #channel</code></li>
<li><code>STATUS #channel, statusVar</code></li>
<li><code>XIO #channel, cmd, aux1, aux2, &quot;device&quot;</code></li>
</ul>
<p>See <a node="[object Object]" href="/docs/forge/advanced-topics/language-reference/statements">Statements</a> for complete syntax.</p>
<h2>Related Topics</h2>
<ul>
<li><a node="[object Object]" href="/docs/forge/xio-reference">XIO Reference</a> - Extended I/O commands</li>
<li><a node="[object Object]" href="/docs/forge/advanced-topics/reference/iocb-structure">IOCB Structure</a> - Detailed IOCB reference</li>
<li><a node="[object Object]" href="/docs/forge/advanced-topics/language-reference/statements">Statements</a> - FORGE I/O statements</li>
<li><a node="[object Object]" href="/docs/forge/note-point">NOTE/POINT</a> - File positioning operations</li>
</ul></div></div></div></div></main><footer class="footer"><p>© 2026 Atari Foundry · Rick Collette · Software for Atari 8-bit builders.</p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"product":"forge","productDocs":{"product":"forge","files":[{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/cc65/README.md","relativePath":"cc65/README.md","relativeDir":"cc65","filename":"README","slug":"readme","name":"README"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/README.md","relativePath":"README.md","relativeDir":"","filename":"README","slug":"readme","name":"README"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/about/attributions.md","relativePath":"about/attributions.md","relativeDir":"about","filename":"attributions","slug":"attributions","name":"attributions"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/cio-reference.md","relativePath":"advanced-topics/cio-reference.md","relativeDir":"advanced-topics","filename":"cio-reference","slug":"cio-reference","name":"cio-reference"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/compiling.md","relativePath":"getting-started/compiling.md","relativeDir":"getting-started","filename":"compiling","slug":"compiling","name":"compiling"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/differences.md","relativePath":"getting-started/differences.md","relativeDir":"getting-started","filename":"differences","slug":"differences","name":"differences"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/display-list-interrupts.md","relativePath":"advanced-topics/display-list-interrupts.md","relativeDir":"advanced-topics","filename":"display-list-interrupts","slug":"display-list-interrupts","name":"display-list-interrupts"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/editor/editor-guide.md","relativePath":"editor/editor-guide.md","relativeDir":"editor","filename":"editor-guide","slug":"editor-guide","name":"editor-guide"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/editor/editor-optimization.md","relativePath":"editor/editor-optimization.md","relativeDir":"editor","filename":"editor-optimization","slug":"editor-optimization","name":"editor-optimization"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/expressions.md","relativePath":"language-reference/expressions.md","relativeDir":"language-reference","filename":"expressions","slug":"expressions","name":"expressions"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/first-steps.md","relativePath":"getting-started/first-steps.md","relativeDir":"getting-started","filename":"first-steps","slug":"first-steps","name":"first-steps"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/fujinet.md","relativePath":"advanced-topics/fujinet.md","relativeDir":"advanced-topics","filename":"fujinet","slug":"fujinet","name":"fujinet"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/functions.md","relativePath":"language-reference/functions.md","relativeDir":"language-reference","filename":"functions","slug":"functions","name":"functions"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/hardware-registers.md","relativePath":"reference/hardware-registers.md","relativeDir":"reference","filename":"hardware-registers","slug":"hardware-registers","name":"hardware-registers"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/index.md","relativePath":"index.md","relativeDir":"","filename":"index","slug":"index","name":"index"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/interrupts.md","relativePath":"reference/interrupts.md","relativeDir":"reference","filename":"interrupts","slug":"interrupts","name":"interrupts"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/introduction.md","relativePath":"getting-started/introduction.md","relativeDir":"getting-started","filename":"introduction","slug":"introduction","name":"introduction"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/iocb-structure.md","relativePath":"reference/iocb-structure.md","relativeDir":"reference","filename":"iocb-structure","slug":"iocb-structure","name":"iocb-structure"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/low-level-programming.md","relativePath":"advanced-topics/low-level-programming.md","relativeDir":"advanced-topics","filename":"low-level-programming","slug":"low-level-programming","name":"low-level-programming"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/memory-map.md","relativePath":"reference/memory-map.md","relativeDir":"reference","filename":"memory-map","slug":"memory-map","name":"memory-map"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/memory-usage.md","relativePath":"reference/memory-usage.md","relativeDir":"reference","filename":"memory-usage","slug":"memory-usage","name":"memory-usage"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/note-point.md","relativePath":"advanced-topics/note-point.md","relativeDir":"advanced-topics","filename":"note-point","slug":"note-point","name":"note-point"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/os-equates.md","relativePath":"reference/os-equates.md","relativeDir":"reference","filename":"os-equates","slug":"os-equates","name":"os-equates"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/r-handler.md","relativePath":"reference/r-handler.md","relativeDir":"reference","filename":"r-handler","slug":"r-handler","name":"r-handler"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/sio-operations.md","relativePath":"advanced-topics/sio-operations.md","relativeDir":"advanced-topics","filename":"sio-operations","slug":"sio-operations","name":"sio-operations"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/statements.md","relativePath":"language-reference/statements.md","relativeDir":"language-reference","filename":"statements","slug":"statements","name":"statements"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/syntax.md","relativePath":"language-reference/syntax.md","relativeDir":"language-reference","filename":"syntax","slug":"syntax","name":"syntax"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/about/why-forge.md","relativePath":"about/why-forge.md","relativeDir":"about","filename":"why-forge","slug":"why-forge","name":"why-forge"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/xio-reference.md","relativePath":"advanced-topics/xio-reference.md","relativeDir":"advanced-topics","filename":"xio-reference","slug":"xio-reference","name":"xio-reference"}],"navTree":{"cc65":{"_files":[{"name":"README","slug":"readme","path":"cc65/README.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/cc65/README.md","isIndex":true}]},"_files":[{"name":"README","slug":"readme","path":"README.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/README.md","isIndex":true},{"name":"index","slug":"index","path":"index.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/index.md","isIndex":false}],"about":{"_files":[{"name":"attributions","slug":"attributions","path":"about/attributions.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/about/attributions.md","isIndex":false},{"name":"why-forge","slug":"why-forge","path":"about/why-forge.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/about/why-forge.md","isIndex":false}]},"advanced-topics":{"_files":[{"name":"cio-reference","slug":"cio-reference","path":"advanced-topics/cio-reference.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/cio-reference.md","isIndex":false},{"name":"display-list-interrupts","slug":"display-list-interrupts","path":"advanced-topics/display-list-interrupts.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/display-list-interrupts.md","isIndex":false},{"name":"fujinet","slug":"fujinet","path":"advanced-topics/fujinet.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/fujinet.md","isIndex":false},{"name":"low-level-programming","slug":"low-level-programming","path":"advanced-topics/low-level-programming.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/low-level-programming.md","isIndex":false},{"name":"note-point","slug":"note-point","path":"advanced-topics/note-point.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/note-point.md","isIndex":false},{"name":"sio-operations","slug":"sio-operations","path":"advanced-topics/sio-operations.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/sio-operations.md","isIndex":false},{"name":"xio-reference","slug":"xio-reference","path":"advanced-topics/xio-reference.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/xio-reference.md","isIndex":false}]},"getting-started":{"_files":[{"name":"compiling","slug":"compiling","path":"getting-started/compiling.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/compiling.md","isIndex":false},{"name":"differences","slug":"differences","path":"getting-started/differences.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/differences.md","isIndex":false},{"name":"first-steps","slug":"first-steps","path":"getting-started/first-steps.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/first-steps.md","isIndex":false},{"name":"introduction","slug":"introduction","path":"getting-started/introduction.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/getting-started/introduction.md","isIndex":false}]},"editor":{"_files":[{"name":"editor-guide","slug":"editor-guide","path":"editor/editor-guide.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/editor/editor-guide.md","isIndex":false},{"name":"editor-optimization","slug":"editor-optimization","path":"editor/editor-optimization.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/editor/editor-optimization.md","isIndex":false}]},"language-reference":{"_files":[{"name":"expressions","slug":"expressions","path":"language-reference/expressions.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/expressions.md","isIndex":false},{"name":"functions","slug":"functions","path":"language-reference/functions.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/functions.md","isIndex":false},{"name":"statements","slug":"statements","path":"language-reference/statements.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/statements.md","isIndex":false},{"name":"syntax","slug":"syntax","path":"language-reference/syntax.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/language-reference/syntax.md","isIndex":false}]},"reference":{"_files":[{"name":"hardware-registers","slug":"hardware-registers","path":"reference/hardware-registers.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/hardware-registers.md","isIndex":false},{"name":"interrupts","slug":"interrupts","path":"reference/interrupts.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/interrupts.md","isIndex":false},{"name":"iocb-structure","slug":"iocb-structure","path":"reference/iocb-structure.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/iocb-structure.md","isIndex":false},{"name":"memory-map","slug":"memory-map","path":"reference/memory-map.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/memory-map.md","isIndex":false},{"name":"memory-usage","slug":"memory-usage","path":"reference/memory-usage.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/memory-usage.md","isIndex":false},{"name":"os-equates","slug":"os-equates","path":"reference/os-equates.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/os-equates.md","isIndex":false},{"name":"r-handler","slug":"r-handler","path":"reference/r-handler.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/reference/r-handler.md","isIndex":false}]}}},"docFile":{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/forge/advanced-topics/cio-reference.md","relativePath":"advanced-topics/cio-reference.md","relativeDir":"advanced-topics","filename":"cio-reference","slug":"cio-reference","name":"cio-reference","content":"# CIO Reference\n\nThe Central Input/Output Utility (CIO) is the primary I/O system used by the Atari 8-bit computers. Nearly all input or output passes through this utility.\n\n## Overview\n\nCIO uses eight \"channels\" as paths for I/O. There are not really separate channels for I/O but the computer acts as if there were. Each channel is controlled by a 16 byte block of memory called an Input/Output Control Block or IOCB.\n\n## CIO Channels\n\nThere are eight CIO channels, numbered from 0 to 7. In BASIC some channels are reserved for BASIC's use.\n\n### BASIC CIO Channel Assignments\n\n| Channel | Assignment |\n|---------|------------|\n| 0       | Permanently assigned to the screen editor |\n| 6       | Used for graphics commands |\n| 7       | Used for the Cassette, disk and printer |\n\nChannels 6 and 7 are free to use when they are not being used by BASIC. With machine language, all of the channels are available to the programmer.\n\n## IOCB Structure\n\nThe IOCB for channel zero starts at address $0340 (decimal 832). This is the only address you need to know. Indexing from this address is used to find all of the other bytes.\n\n### IOCB Bytes and Uses\n\n| Address | Name   | Explanation |\n|---------|--------|-------------|\n| $0340   | ICHID  | Handler Identifier |\n| $0341   | ICDNO  | Device number (disk) |\n| $0342   | ICCOM  | Command |\n| $0343   | ICSTA  | Status |\n| $0344   | ICBAL  | Buffer address (low byte) |\n| $0345   | ICBAH  | Buffer address (high byte) |\n| $0346   | ICPTL  | Address of put byte routine (used by BASIC) |\n| $0347   | ICPTH  | Address of put byte routine (used by BASIC) |\n| $0348   | ICBLL  | Buffer length (low byte) |\n| $0349   | ICBLH  | Buffer length (high byte) |\n| $034A   | ICAX1  | Auxiliary information |\n| $034B   | ICAX2  | - |\n| $034C   | ICAX3  | The remaining auxiliary bytes are rarely used |\n| $034D   | ICAX4  | - |\n| $034E   | ICAX5  | - |\n| $034F   | ICAX6  | - |\n\n### ICHID\n\nWhen a channel is open, the handler I.D. contains an index to the handler table. The handler table holds the address of the device handling routines. When the channel is closed ICHID contains $FF.\n\n### ICDNO\n\nThe device number is used to distinguish between multiple devices with the same name, such as disk drives.\n\n### ICCOM\n\nThe command byte tells CIO what operation to perform.\n\n### ICSTA\n\nThe status byte contains an error code if something goes wrong. If bit 7 is 0 there have been no errors.\n\n### ICBAL and ICBAH\n\nBefore a channel is opened, the buffer address bytes are set point to the block of memory which contains the name of the device the channel is to be opened to. Before actual input or output these bytes are set to point to the block of memory where the I/O data is stored or is to be stored.\n\n### ICBLL and ICBLH\n\nThe buffer length bytes show the number of bytes in the block of memory used to store the input or output data. If the amount of data read during an input operation is less than the length of the buffer, the number of bytes actually read will be put in ICBLL and ICBLH by CIO.\n\n### ICAX1 through ICAX6\n\nThe auxiliary information bytes are used to give CIO or the device any special information needed.\n\n## CIO Command Codes\n\n| Hex | Dec | Command | Notes |\n|-----|-----|---------|-------|\n| $03 | 3  | Open    | May be made to a closed channel |\n| $05 | 5  | Get Record | - |\n| $07 | 7  | Get     | - |\n| $09 | 9  | Print   | - |\n| $0B | 11 | Put     | - |\n| $0C | 12 | Close   | May be made to a closed channel |\n| $0D | 13 | Status  | May be made to a closed channel |\n| \u003e$0D | \u003e13 | Special | Device specific commands |\n\n## Opening a CIO Channel\n\nBefore using a CIO channel it must be assigned to an I/O device.\n\n### Channel-Open Parameters\n\n- **ICCOM** - open code ($03)\n- **ICBAL** - address of device name in memory (low byte)\n- **ICBAH** - address of device name in memory (high byte)\n- **ICAX1** - direction code\n- **ICAX2** - zero\n\n### Direction Codes (ICAX1)\n\n| Hex | Dec | Operation |\n|-----|-----|-----------|\n| $04 | 4  | Input |\n| $08 | 8  | Output |\n| $0C | 12 | Input and output (cannot change the length of a disk file) |\n\n**ICAX1 format for opening a channel:**\n\n```\n7 6 5 4 3 2 1 0\n----------------\n|        W R    |\n----------------\n        8 4 2 1\n```\n\n- W = 1 = open for output (write)\n- R = 1 = open for input (read)\n\n### Device Names\n\nICBAL and ICBAH point to the device name stored in memory. The device and file name must be followed by 0 or $9B (decimal 155).\n\n**CIO device names:**\n\n| Device | Description |\n|--------|-------------|\n| C      | Cassette recorder |\n| D      | Disk drive (uses non-resident handler) |\n| E      | Screen editor |\n| K      | Keyboard |\n| P      | Printer |\n| R      | RS-232 I/O port (uses non-resident handler) |\n| S      | Screen handler |\n\nThe device name must usually be followed by a colon. With the disk drive a file name is expected after the device name.\n\n## Using an Open Channel\n\n### INPUT (ICCOM = $05)\n\nThe computer reads data from the device until a carriage-return is read (decimal number 155, hex $9B) or the end of the file (EOF) is reached.\n\n**IOCB input parameters:**\n- ICCOM - get record code ($05)\n- ICBAL - address of buffer to store the data in (low byte)\n- ICBAH - address of buffer to store the data in (high byte)\n- ICBLL - length of the data buffer (low byte)\n- ICBLH - length of the data buffer (high byte)\n\nIf the data retrieved is shorter than the prepared buffer, the number of bytes actually read will be put into ICBLL and ICBLH.\n\n### PRINT (ICCOM = $09)\n\nIn assembly language the print command is identical to the input command. The only difference is that the PUTREC code ($09) is stored in ICCOM. The buffer bytes of the IOCB then specify the block of memory to be output from rather than input to. With the print command, EOLs within the string or buffer are ignored but an EOL is placed at the end of the data when sent to the device.\n\n### GET (ICCOM = $07)\n\nIn BASIC this command inputs a single byte of data from the device. EOLs are ignored.\n\n**IOCB get-byte parameters:**\n- ICCOM - get-character (single byte) code ($07)\n- ICBAL, ICBAH, ICBLL, ICBLH - same as in input\n\n### PUT (ICCOM = $0B)\n\nIn BASIC, PUT is the opposite of GET. It outputs a single byte from a variable to the device.\n\nIn assembly language, the command byte of the IOCB is loaded with the put-character code (PUTCHR = $0B). Otherwise the PUT command is identical to GET.\n\n## Closing a Channel\n\nClosing a channel frees it for use by another device or for changing parameters.\n\n**IOCB close command:**\n- ICCOM - close code ($0C)\n\nWith the disk drive, the file name is not put into the directory until the channel is closed.\n\n## Status Codes\n\nICSTA (IOCB status byte) is the result code from the last CIO operation done on that IOCB.\n\n**Location:** 851 decimal = $0353 (for IOCB1)\n\n**Meaning:**\n- 0 = success\n- Anything else = some kind of error or special condition\n\n### Common Status Values\n\n**Success:**\n- 0 = OK / Success\n\n**Non-fatal / end-of-data:**\n- 136 ($88) = End of File (EOF)\n- 137 ($89) = Truncated record / line too long\n\n**Fatal errors (128-255):**\n- Bad IOCB / channel not open\n- Device/handler not found\n- Bad command\n- Invalid parameter\n- Timeout\n- Device NAK / not responding\n- Framing / overrun errors (serial)\n\n### Interpreting ICSTA\n\n**Simple check:**\n```basic\nS = PEEK(851)\nIF S = 0 THEN ? \"OK\" ELSE ? \"ERROR/STATUS=\"; S\n```\n\n**With EOF handling:**\n```basic\nS = PEEK(851)\nIF S = 0 THEN ? \"OK\"\nIF S = 136 THEN ? \"EOF\"\nIF S \u003e 127 AND S \u003c\u003e 136 THEN ? \"ERROR=\"; S\n```\n\n## Device Table\n\nCIO uses a jump table located at $031A (794). When a CIO call is made, CIO searches the table for the one-byte device name. The two bytes following the device name contain the address of the device handler's vector table. CIO searches the device table from the end, $033D (829) to the beginning.\n\n## Handler Vector Table\n\nEach handler has its own vector table. This vector table is 16 bytes long. The two-byte vectors point to the various handler routines.\n\n**Handler vector table order:**\n1. open\n2. close\n3. get byte\n4. put byte\n5. get stat\n6. special\n7. JMP init code (3 bytes)\n\n## Important Addresses\n\n| Name   | Address | Description |\n|--------|---------|-------------|\n| DOSINI | $000C,2 | Initialization vector |\n| BRKKEY | $0011   | Break key flag |\n| ICHID  | $0340   | Start of IOCBs |\n| HATABS | $031A,16| Device handler table |\n| CIOV   | $E456   | CIO entry vector |\n\n## FORGE Usage\n\nIn FORGE, you typically use high-level statements that call CIO internally:\n\n- `OPEN #channel, mode, aux, \"device\"`\n- `INPUT #channel, variable`\n- `PRINT #channel, data`\n- `GET #channel, variable`\n- `PUT #channel, value`\n- `CLOSE #channel`\n- `STATUS #channel, statusVar`\n- `XIO #channel, cmd, aux1, aux2, \"device\"`\n\nSee [Statements](../language-reference/statements.md) for complete syntax.\n\n## Related Topics\n\n- [XIO Reference](xio-reference.md) - Extended I/O commands\n- [IOCB Structure](../reference/iocb-structure.md) - Detailed IOCB reference\n- [Statements](../language-reference/statements.md) - FORGE I/O statements\n- [NOTE/POINT](note-point.md) - File positioning operations\n"},"currentPath":"advanced-topics/cio-reference"},"__N_SSG":true},"page":"/docs/[...slug]","query":{"slug":["forge","advanced-topics","cio-reference"]},"buildId":"qaNXmQ4K6kOqdwj6jY2RG","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>