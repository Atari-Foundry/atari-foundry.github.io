<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><title data-next-head="">USER GUIDE | crucible Documentation | Atari Foundry</title><meta name="description" content="crucible documentation: USER GUIDE" data-next-head=""/><link rel="preload" href="/images/foundry_logo_50H.png" as="image" data-next-head=""/><link rel="preload" href="/_next/static/chunks/c81f129e50a5fd79.css" as="style"/><link rel="stylesheet" href="/_next/static/chunks/c81f129e50a5fd79.css" data-n-g=""/><noscript data-n-css=""></noscript><script src="/_next/static/chunks/e8a4a4ae55bc5744.js" defer=""></script><script src="/_next/static/chunks/00dac80f236dcabb.js" defer=""></script><script src="/_next/static/chunks/44f6bc00d9aaf830.js" defer=""></script><script src="/_next/static/chunks/fd7cb30d70431a0f.js" defer=""></script><script src="/_next/static/chunks/turbopack-4769270d21ef6607.js" defer=""></script><script src="/_next/static/chunks/1b081b821847ed60.js" defer=""></script><script src="/_next/static/chunks/76d09b6b03e70f66.js" defer=""></script><script src="/_next/static/chunks/b56fd671c61106a7.js" defer=""></script><script src="/_next/static/chunks/turbopack-d90ce600b0329ce0.js" defer=""></script><script src="/_next/static/CnF04P5ob_bUVxETgw2P_/_ssgManifest.js" defer=""></script><script src="/_next/static/CnF04P5ob_bUVxETgw2P_/_buildManifest.js" defer=""></script></head><body><div id="__next"><div class="crt"><div class="scanlines" aria-hidden="true"></div><div class="noise" aria-hidden="true"></div><nav class="nav"><a class="nav-brand" href="/"><img alt="Atari Foundry icon" width="72" height="50" decoding="async" data-nimg="1" style="color:transparent;height:40px;width:auto" src="/images/foundry_logo_50H.png"/><div><span class="nav-brand-title">Atari Foundry</span><span class="nav-brand-sub">Products for Atari 8-bit</span></div></a><ul class="nav-links"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/vault">Vault</a></li><li class="nav-item has-children"><button type="button" class="nav-link nav-trigger active" aria-haspopup="true" aria-expanded="false">Docs</button><div class="nav-dropdown"><a class="nav-dropdown-link" href="/docs/crucible">Crucible</a><a class="nav-dropdown-link" href="/docs/atrforge">atrforge</a><a class="nav-dropdown-link" href="/docs/forge">FORGE</a></div></li><li class="nav-item"><a class="nav-link" href="/downloads">Downloads</a></li><li class="nav-item"><a class="nav-link" href="/support">Support</a></li></ul></nav><header class="subhero"><p class="label">crucible<!-- --> Documentation</p><h1 class="page-title">USER GUIDE</h1></header><main><div class="docs-layout"><aside class="docs-sidebar"><nav class="docs-nav"><div class="docs-nav-section"><h3>Documentation</h3><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:0rem" href="/docs/crucible/readme">README</a></li><li><a class="doc-link " style="padding-left:0rem" href="/docs/crucible/api-reference">API REFERENCE</a></li><li><a class="doc-link " style="padding-left:0rem" href="/docs/crucible/architecture">ARCHITECTURE</a></li><li><a class="doc-link " style="padding-left:0rem" href="/docs/crucible/attributions">ATTRIBUTIONS</a></li><li><a class="doc-link " style="padding-left:0rem" href="/docs/crucible/building">BUILDING</a></li><li><a class="doc-link " style="padding-left:0rem" href="/docs/crucible/changelog">CHANGELOG</a></li><li><a class="doc-link active" style="padding-left:0rem" href="/docs/crucible/user-guide">USER GUIDE</a></li></ul></div></nav></aside><div class="docs-content"><div class="docs-body"><div class="doc-markdown"><h1>Crucible User Guide</h1>
<h2>Table of Contents</h2>
<ol>
<li><a node="[object Object]" href="/docs/crucible/user-guide#introduction">Introduction</a></li>
<li><a node="[object Object]" href="/docs/crucible/user-guide#installation">Installation</a></li>
<li><a node="[object Object]" href="/docs/crucible/user-guide#quick-start">Quick Start</a></li>
<li><a node="[object Object]" href="/docs/crucible/user-guide#command-line-options">Command-Line Options</a></li>
<li><a node="[object Object]" href="/docs/crucible/user-guide#device-support">Device Support</a></li>
<li><a node="[object Object]" href="/docs/crucible/user-guide#file-formats">File Formats</a></li>
<li><a node="[object Object]" href="/docs/crucible/user-guide#examples">Examples</a></li>
<li><a node="[object Object]" href="/docs/crucible/user-guide#troubleshooting">Troubleshooting</a></li>
</ol>
<h2>Introduction</h2>
<p>Crucible is a small 6502 simulator designed to debug and run command-line (console-only) Atari 8-bit programs. It provides a subset of the Atari BIOS and hardware emulation, making it ideal for testing and debugging Atari software without requiring a full emulator.</p>
<h3>Key Features</h3>
<ul>
<li><strong>6502 CPU Emulation</strong>: Full 6502 instruction set support</li>
<li><strong>Atari BIOS Emulation</strong>: CIO, DOS, and hardware register support</li>
<li><strong>ATR Filesystem Access</strong>: Read files from ATR disk images</li>
<li><strong>Host Filesystem Access</strong>: Access local files via H: device</li>
<li><strong>Hardware Emulation</strong>: POKEY, GTIA, ANTIC, PIA registers</li>
<li><strong>Debugging Support</strong>: Tracing, profiling, and label files</li>
<li><strong>Cross-Platform</strong>: Works on Linux, macOS, and Windows</li>
</ul>
<h2>Installation</h2>
<h3>Prerequisites</h3>
<ul>
<li>GCC compiler (or compatible C compiler)</li>
<li>Make</li>
<li>Standard C library</li>
<li>Math library (<code>-lm</code>)</li>
</ul>
<h3>Building from Source</h3>
<pre><pre class="language-bash"><code class="language-bash"># Clone or download the source code
cd crucible

# Build the project
make

# The executable will be in build/crucible
./build/crucible -h
</code></pre></pre>
<h3>Build Options</h3>
<ul>
<li><code>make</code> - Build the project</li>
<li><code>make clean</code> - Remove all build artifacts</li>
<li><code>make help</code> - Show build system help</li>
<li><code>make test</code> - Run automated tests</li>
</ul>
<h2>Quick Start</h2>
<h3>Running a Simple Program</h3>
<pre><pre class="language-bash"><code class="language-bash"># Run a XEX file
./build/crucible program.xex

# Run with debug output
./build/crucible -d program.xex

# Run with ATR disk image
./build/crucible -I disk.atr program.xex
</code></pre></pre>
<h3>Basic Examples</h3>
<pre><pre class="language-bash"><code class="language-bash"># Print &quot;HELLO&quot; (if you have hello.xex)
./build/crucible testfiles/hello.xex

# Access host filesystem
./build/crucible -R /path/to/files program.xex

# Boot from ATR image
./build/crucible -I disk.atr
</code></pre></pre>
<h2>Command-Line Options</h2>
<h3>Basic Options</h3>
<ul>
<li><code>-h</code> - Show help message</li>
<li><code>-d</code> - Print debug messages to standard error</li>
<li><code>-b</code> - Use binary mode for standard input/output (no ATASCII translation)</li>
<li><code>-D</code> - Don&#x27;t emulate DOS device</li>
</ul>
<h3>File Options</h3>
<ul>
<li>
<p><code>-I &lt;file&gt;</code> - Load ATR disk image for SIO emulation</p>
<ul>
<li>If no executable is given, boots from this image</li>
<li>Example: <code>-I disk.atr</code></li>
</ul>
</li>
<li>
<p><code>-R &lt;path&gt;</code> - Set root path for D: and H: devices</p>
<ul>
<li>Sets the base directory for file access</li>
<li>Example: <code>-R /home/user/atari_files</code></li>
</ul>
</li>
<li>
<p><code>-r &lt;addr&gt;</code> - Load ROM at given address instead of XEX file</p>
<ul>
<li>Address can be in decimal or hexadecimal (0x prefix)</li>
<li>Example: <code>-r 0xC000</code></li>
</ul>
</li>
</ul>
<h3>Debugging Options</h3>
<ul>
<li>
<p><code>-e &lt;level&gt;</code> - Set error level</p>
<ul>
<li><code>none</code> or <code>n</code> - No error reporting</li>
<li><code>mem</code> or <code>m</code> - Memory errors only</li>
<li><code>full</code> or <code>f</code> - All errors (default)</li>
<li>Example: <code>-e mem</code></li>
</ul>
</li>
<li>
<p><code>-t &lt;file&gt;</code> - Store simulation trace to file</p>
<ul>
<li>Records instruction execution trace</li>
<li>Example: <code>-t trace.txt</code></li>
</ul>
</li>
<li>
<p><code>-l &lt;file&gt;</code> - Load label file for trace output</p>
<ul>
<li>Makes trace output more readable</li>
<li>Can specify multiple times (last one takes precedence)</li>
<li>Example: <code>-l labels.txt</code></li>
</ul>
</li>
</ul>
<h3>Profiling Options</h3>
<ul>
<li>
<p><code>-p &lt;file&gt;</code> - Store profile information to file</p>
<ul>
<li>Text format profile data</li>
<li>Example: <code>-p profile.txt</code></li>
</ul>
</li>
<li>
<p><code>-P &lt;file&gt;</code> - Read/write binary profile data</p>
<ul>
<li>Can consolidate multiple profile runs</li>
<li>Example: <code>-P profile.bin</code></li>
</ul>
</li>
</ul>
<h3>Advanced Options (<code>-o</code>)</h3>
<ul>
<li><code>ntsc</code> - Emulate NTSC machine timings (60Hz) - <strong>default</strong></li>
<li><code>pal</code> - Emulate PAL machine timings (50Hz)</li>
<li><code>realtime</code> - Base time on real elapsed times - <strong>default</strong></li>
<li><code>cycletime</code> - Base time on number of CPU cycles</li>
<li><code>fastmath</code> - Use Altirra fast math pack - <strong>default</strong></li>
<li><code>atarimath</code> - Use original Atari math pack</li>
</ul>
<p>Multiple options can be specified: <code>-o ntsc,fastmath</code></p>
<h3>Usage Examples</h3>
<pre><pre class="language-bash"><code class="language-bash"># Full debugging session
./build/crucible -d -t trace.txt -l labels.txt program.xex

# Profile a program
./build/crucible -p profile.txt program.xex

# Run with ATR image and custom root path
./build/crucible -I disk.atr -R /data/atari program.xex

# PAL timing with original math pack
./build/crucible -o pal,atarimath program.xex
</code></pre></pre>
<h2>Device Support</h2>
<h3>E: Device (Editor/Screen)</h3>
<ul>
<li><strong>Purpose</strong>: Standard input/output</li>
<li><strong>Input</strong>: Reads from standard input (stdin)</li>
<li><strong>Output</strong>: Writes to standard output (stdout)</li>
<li><strong>Translation</strong>: ATASCII to/from ASCII (unless <code>-b</code> flag used)</li>
</ul>
<h3>D: Device (Disk)</h3>
<ul>
<li><strong>Purpose</strong>: ATR disk image access</li>
<li><strong>Format</strong>: DOS 2.x, SpartaDOS, BW-DOS</li>
<li><strong>Features</strong>:<!-- -->
<ul>
<li>File reading from ATR images</li>
<li>Directory listing</li>
<li>Subdirectory navigation</li>
<li>File attribute support</li>
</ul>
</li>
<li><strong>Usage</strong>: Load with <code>-I</code> option</li>
<li><strong>Limitations</strong>: Read-only (no file writing to ATR)</li>
</ul>
<h3>H: Device (Host)</h3>
<ul>
<li><strong>Purpose</strong>: Host filesystem access</li>
<li><strong>Features</strong>:<!-- -->
<ul>
<li>File reading and writing</li>
<li>Directory listing</li>
<li>Full CIO compatibility</li>
</ul>
</li>
<li><strong>Root Path</strong>: Set with <code>-R</code> option (defaults to current directory)</li>
<li><strong>Example</strong>: <code>H1:FILE.TXT</code> accesses <code>FILE.TXT</code> in root path</li>
</ul>
<h3>K: Device (Keyboard)</h3>
<ul>
<li><strong>Purpose</strong>: Character input from console</li>
<li><strong>Features</strong>: Single character input with ATASCII translation</li>
</ul>
<h3>R: Device (RS-232/Serial)</h3>
<ul>
<li><strong>Purpose</strong>: Serial I/O emulation</li>
<li><strong>Features</strong>:<!-- -->
<ul>
<li>Baud rate configuration</li>
<li>Translation mode support</li>
<li>Basic serial communication</li>
</ul>
</li>
</ul>
<h2>File Formats</h2>
<h3>XEX Files</h3>
<ul>
<li><strong>Format</strong>: Atari executable format</li>
<li><strong>Extension</strong>: <code>.xex</code></li>
<li><strong>Structure</strong>: Multiple segments with load addresses</li>
<li><strong>Usage</strong>: Primary format for running Atari programs</li>
</ul>
<h3>ATR Files</h3>
<ul>
<li><strong>Format</strong>: Atari disk image format</li>
<li><strong>Extension</strong>: <code>.atr</code></li>
<li><strong>Structure</strong>: Header + sector data</li>
<li><strong>Sizes</strong>: Up to 16MB supported (65535 sectors × 256 bytes)</li>
<li><strong>Sector Sizes</strong>: 128 or 256 bytes per sector</li>
<li><strong>Usage</strong>: Load with <code>-I</code> option</li>
</ul>
<h3>Label Files</h3>
<ul>
<li><strong>Format</strong>: Text file with address labels</li>
<li><strong>Purpose</strong>: Makes trace output readable</li>
<li><strong>Format</strong>: <code>LABEL = $ADDRESS</code> or <code>LABEL = ADDRESS</code></li>
<li><strong>Example</strong>:<!-- -->
<pre><code>MAIN = $0600
LOOP = $0620
</code></pre>
</li>
</ul>
<h2>Examples</h2>
<h3>Example 1: Simple Program Execution</h3>
<pre><pre class="language-bash"><code class="language-bash"># Run a hello world program
./build/crucible hello.xex
# Output: HELLO
</code></pre></pre>
<h3>Example 2: Debugging with Trace</h3>
<pre><pre class="language-bash"><code class="language-bash"># Create a label file (labels.txt)
echo &quot;MAIN = \$0600&quot; &gt; labels.txt
echo &quot;LOOP = \$0620&quot; &gt;&gt; labels.txt

# Run with trace
./build/crucible -d -t trace.txt -l labels.txt program.xex
</code></pre></pre>
<h3>Example 3: Working with ATR Images</h3>
<pre><pre class="language-bash"><code class="language-bash"># Boot from ATR image
./build/crucible -I disk.atr

# Run program with ATR image loaded
./build/crucible -I disk.atr program.xex
</code></pre></pre>
<h3>Example 4: Host Filesystem Access</h3>
<pre><pre class="language-bash"><code class="language-bash"># Set root path and run program
./build/crucible -R /home/user/atari_files program.xex

# Program can access files via H: device
# H1:FILE.TXT maps to /home/user/atari_files/FILE.TXT
</code></pre></pre>
<h3>Example 5: Profiling</h3>
<pre><pre class="language-bash"><code class="language-bash"># Generate profile
./build/crucible -p profile.txt program.xex

# View profile (shows cycle counts per instruction)
cat profile.txt
</code></pre></pre>
<h2>Troubleshooting</h2>
<h3>Program Doesn&#x27;t Run</h3>
<ul>
<li><strong>Check file format</strong>: Ensure file is valid XEX format</li>
<li><strong>Check debug output</strong>: Use <code>-d</code> flag to see what&#x27;s happening</li>
<li><strong>Check error level</strong>: Use <code>-e full</code> to see all errors</li>
</ul>
<h3>ATR Image Not Loading</h3>
<ul>
<li><strong>Check file format</strong>: Ensure ATR has valid header</li>
<li><strong>Check file size</strong>: Supported up to 16MB</li>
<li><strong>Check sector size</strong>: Must be 128 or 256 bytes</li>
</ul>
<h3>File Access Issues</h3>
<ul>
<li><strong>D: Device</strong>: Requires ATR image loaded with <code>-I</code></li>
<li><strong>H: Device</strong>: Check root path with <code>-R</code> option</li>
<li><strong>Permissions</strong>: Ensure files are readable/writable</li>
</ul>
<h3>Debug Output Too Verbose</h3>
<ul>
<li><strong>Use error levels</strong>: <code>-e mem</code> or <code>-e none</code></li>
<li><strong>Filter output</strong>: Redirect stderr to file</li>
<li><strong>Use labels</strong>: Makes trace output more readable</li>
</ul>
<h3>Performance Issues</h3>
<ul>
<li><strong>Use cycle-based timing</strong>: <code>-o cycletime</code></li>
<li><strong>Disable DOS</strong>: <code>-D</code> flag if not needed</li>
<li><strong>Reduce debug output</strong>: Remove <code>-d</code> flag</li>
</ul>
<h3>Common Error Messages</h3>
<ul>
<li><strong>&quot;can&#x27;t open disk image&quot;</strong>: Check file path and permissions</li>
<li><strong>&quot;invalid instruction&quot;</strong>: Program may have bugs or incompatible code</li>
<li><strong>&quot;channel not open&quot;</strong>: Program trying to access closed IOCB</li>
<li><strong>&quot;invalid command&quot;</strong>: Unsupported CIO command</li>
</ul>
<h3>Getting Help</h3>
<ul>
<li>Use <code>-h</code> flag for command-line help</li>
<li>Check documentation in <code>docs/</code> folder</li>
<li>Review test files in <code>testfiles/</code> for examples</li>
<li>Enable debug output with <code>-d</code> flag</li>
</ul>
<h2>Advanced Usage</h2>
<h3>Custom I/O Handlers</h3>
<p>The simulator supports custom character I/O handlers through the API (see API_REFERENCE.md for details).</p>
<h3>Label File Format</h3>
<p>Labels can be specified in multiple formats:</p>
<ul>
<li><code>LABEL = $1234</code> (hexadecimal)</li>
<li><code>LABEL = 1234</code> (decimal)</li>
<li><code>LABEL = 0x1234</code> (hexadecimal with 0x prefix)</li>
</ul>
<h3>Profile Analysis</h3>
<p>Profile files show:</p>
<ul>
<li>Cycle counts per instruction address</li>
<li>Branch statistics</li>
<li>Memory access patterns</li>
<li>Performance hotspots</li>
</ul>
<h3>Trace Analysis</h3>
<p>Trace files show:</p>
<ul>
<li>Instruction execution sequence</li>
<li>Register values</li>
<li>Memory accesses</li>
<li>Call stack information</li>
</ul>
<h2>See Also</h2>
<ul>
<li><a node="[object Object]" href="/docs/crucible/architecture">Architecture Documentation</a> - Technical details</li>
<li><a node="[object Object]" href="/docs/crucible/api-reference">API Reference</a> - Developer documentation</li>
<li><a node="[object Object]" href="/docs/crucible/building">Building Guide</a> - Build system details</li>
<li><a node="[object Object]" href="/docs/crucible/changelog">Changelog</a> - Version history</li>
</ul></div></div></div></div></main><footer class="footer"><p>© 2026 Atari Foundry · Rick Collette · Software for Atari 8-bit builders.</p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"product":"crucible","productDocs":{"product":"crucible","files":[{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/README.md","relativePath":"README.md","relativeDir":"","filename":"README","slug":"readme","name":"README"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/API_REFERENCE.md","relativePath":"API_REFERENCE.md","relativeDir":"","filename":"API_REFERENCE","slug":"api-reference","name":"API REFERENCE"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ARCHITECTURE.md","relativePath":"ARCHITECTURE.md","relativeDir":"","filename":"ARCHITECTURE","slug":"architecture","name":"ARCHITECTURE"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ATTRIBUTIONS.md","relativePath":"ATTRIBUTIONS.md","relativeDir":"","filename":"ATTRIBUTIONS","slug":"attributions","name":"ATTRIBUTIONS"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/BUILDING.md","relativePath":"BUILDING.md","relativeDir":"","filename":"BUILDING","slug":"building","name":"BUILDING"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/CHANGELOG.md","relativePath":"CHANGELOG.md","relativeDir":"","filename":"CHANGELOG","slug":"changelog","name":"CHANGELOG"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/USER_GUIDE.md","relativePath":"USER_GUIDE.md","relativeDir":"","filename":"USER_GUIDE","slug":"user-guide","name":"USER GUIDE"}],"navTree":{"_files":[{"name":"README","slug":"readme","path":"README.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/README.md","isIndex":true},{"name":"API REFERENCE","slug":"api-reference","path":"API_REFERENCE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/API_REFERENCE.md","isIndex":false},{"name":"ARCHITECTURE","slug":"architecture","path":"ARCHITECTURE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ARCHITECTURE.md","isIndex":false},{"name":"ATTRIBUTIONS","slug":"attributions","path":"ATTRIBUTIONS.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ATTRIBUTIONS.md","isIndex":false},{"name":"BUILDING","slug":"building","path":"BUILDING.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/BUILDING.md","isIndex":false},{"name":"CHANGELOG","slug":"changelog","path":"CHANGELOG.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/CHANGELOG.md","isIndex":false},{"name":"USER GUIDE","slug":"user-guide","path":"USER_GUIDE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/USER_GUIDE.md","isIndex":false}]}},"docFile":{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/USER_GUIDE.md","relativePath":"USER_GUIDE.md","relativeDir":"","filename":"USER_GUIDE","slug":"user-guide","name":"USER GUIDE","content":"# Crucible User Guide\n\n## Table of Contents\n\n1. [Introduction](#introduction)\n2. [Installation](#installation)\n3. [Quick Start](#quick-start)\n4. [Command-Line Options](#command-line-options)\n5. [Device Support](#device-support)\n6. [File Formats](#file-formats)\n7. [Examples](#examples)\n8. [Troubleshooting](#troubleshooting)\n\n## Introduction\n\nCrucible is a small 6502 simulator designed to debug and run command-line (console-only) Atari 8-bit programs. It provides a subset of the Atari BIOS and hardware emulation, making it ideal for testing and debugging Atari software without requiring a full emulator.\n\n### Key Features\n\n- **6502 CPU Emulation**: Full 6502 instruction set support\n- **Atari BIOS Emulation**: CIO, DOS, and hardware register support\n- **ATR Filesystem Access**: Read files from ATR disk images\n- **Host Filesystem Access**: Access local files via H: device\n- **Hardware Emulation**: POKEY, GTIA, ANTIC, PIA registers\n- **Debugging Support**: Tracing, profiling, and label files\n- **Cross-Platform**: Works on Linux, macOS, and Windows\n\n## Installation\n\n### Prerequisites\n\n- GCC compiler (or compatible C compiler)\n- Make\n- Standard C library\n- Math library (`-lm`)\n\n### Building from Source\n\n```bash\n# Clone or download the source code\ncd crucible\n\n# Build the project\nmake\n\n# The executable will be in build/crucible\n./build/crucible -h\n```\n\n### Build Options\n\n- `make` - Build the project\n- `make clean` - Remove all build artifacts\n- `make help` - Show build system help\n- `make test` - Run automated tests\n\n## Quick Start\n\n### Running a Simple Program\n\n```bash\n# Run a XEX file\n./build/crucible program.xex\n\n# Run with debug output\n./build/crucible -d program.xex\n\n# Run with ATR disk image\n./build/crucible -I disk.atr program.xex\n```\n\n### Basic Examples\n\n```bash\n# Print \"HELLO\" (if you have hello.xex)\n./build/crucible testfiles/hello.xex\n\n# Access host filesystem\n./build/crucible -R /path/to/files program.xex\n\n# Boot from ATR image\n./build/crucible -I disk.atr\n```\n\n## Command-Line Options\n\n### Basic Options\n\n- `-h` - Show help message\n- `-d` - Print debug messages to standard error\n- `-b` - Use binary mode for standard input/output (no ATASCII translation)\n- `-D` - Don't emulate DOS device\n\n### File Options\n\n- `-I \u003cfile\u003e` - Load ATR disk image for SIO emulation\n  - If no executable is given, boots from this image\n  - Example: `-I disk.atr`\n\n- `-R \u003cpath\u003e` - Set root path for D: and H: devices\n  - Sets the base directory for file access\n  - Example: `-R /home/user/atari_files`\n\n- `-r \u003caddr\u003e` - Load ROM at given address instead of XEX file\n  - Address can be in decimal or hexadecimal (0x prefix)\n  - Example: `-r 0xC000`\n\n### Debugging Options\n\n- `-e \u003clevel\u003e` - Set error level\n  - `none` or `n` - No error reporting\n  - `mem` or `m` - Memory errors only\n  - `full` or `f` - All errors (default)\n  - Example: `-e mem`\n\n- `-t \u003cfile\u003e` - Store simulation trace to file\n  - Records instruction execution trace\n  - Example: `-t trace.txt`\n\n- `-l \u003cfile\u003e` - Load label file for trace output\n  - Makes trace output more readable\n  - Can specify multiple times (last one takes precedence)\n  - Example: `-l labels.txt`\n\n### Profiling Options\n\n- `-p \u003cfile\u003e` - Store profile information to file\n  - Text format profile data\n  - Example: `-p profile.txt`\n\n- `-P \u003cfile\u003e` - Read/write binary profile data\n  - Can consolidate multiple profile runs\n  - Example: `-P profile.bin`\n\n### Advanced Options (`-o`)\n\n- `ntsc` - Emulate NTSC machine timings (60Hz) - **default**\n- `pal` - Emulate PAL machine timings (50Hz)\n- `realtime` - Base time on real elapsed times - **default**\n- `cycletime` - Base time on number of CPU cycles\n- `fastmath` - Use Altirra fast math pack - **default**\n- `atarimath` - Use original Atari math pack\n\nMultiple options can be specified: `-o ntsc,fastmath`\n\n### Usage Examples\n\n```bash\n# Full debugging session\n./build/crucible -d -t trace.txt -l labels.txt program.xex\n\n# Profile a program\n./build/crucible -p profile.txt program.xex\n\n# Run with ATR image and custom root path\n./build/crucible -I disk.atr -R /data/atari program.xex\n\n# PAL timing with original math pack\n./build/crucible -o pal,atarimath program.xex\n```\n\n## Device Support\n\n### E: Device (Editor/Screen)\n\n- **Purpose**: Standard input/output\n- **Input**: Reads from standard input (stdin)\n- **Output**: Writes to standard output (stdout)\n- **Translation**: ATASCII to/from ASCII (unless `-b` flag used)\n\n### D: Device (Disk)\n\n- **Purpose**: ATR disk image access\n- **Format**: DOS 2.x, SpartaDOS, BW-DOS\n- **Features**:\n  - File reading from ATR images\n  - Directory listing\n  - Subdirectory navigation\n  - File attribute support\n- **Usage**: Load with `-I` option\n- **Limitations**: Read-only (no file writing to ATR)\n\n### H: Device (Host)\n\n- **Purpose**: Host filesystem access\n- **Features**:\n  - File reading and writing\n  - Directory listing\n  - Full CIO compatibility\n- **Root Path**: Set with `-R` option (defaults to current directory)\n- **Example**: `H1:FILE.TXT` accesses `FILE.TXT` in root path\n\n### K: Device (Keyboard)\n\n- **Purpose**: Character input from console\n- **Features**: Single character input with ATASCII translation\n\n### R: Device (RS-232/Serial)\n\n- **Purpose**: Serial I/O emulation\n- **Features**:\n  - Baud rate configuration\n  - Translation mode support\n  - Basic serial communication\n\n## File Formats\n\n### XEX Files\n\n- **Format**: Atari executable format\n- **Extension**: `.xex`\n- **Structure**: Multiple segments with load addresses\n- **Usage**: Primary format for running Atari programs\n\n### ATR Files\n\n- **Format**: Atari disk image format\n- **Extension**: `.atr`\n- **Structure**: Header + sector data\n- **Sizes**: Up to 16MB supported (65535 sectors × 256 bytes)\n- **Sector Sizes**: 128 or 256 bytes per sector\n- **Usage**: Load with `-I` option\n\n### Label Files\n\n- **Format**: Text file with address labels\n- **Purpose**: Makes trace output readable\n- **Format**: `LABEL = $ADDRESS` or `LABEL = ADDRESS`\n- **Example**:\n  ```\n  MAIN = $0600\n  LOOP = $0620\n  ```\n\n## Examples\n\n### Example 1: Simple Program Execution\n\n```bash\n# Run a hello world program\n./build/crucible hello.xex\n# Output: HELLO\n```\n\n### Example 2: Debugging with Trace\n\n```bash\n# Create a label file (labels.txt)\necho \"MAIN = \\$0600\" \u003e labels.txt\necho \"LOOP = \\$0620\" \u003e\u003e labels.txt\n\n# Run with trace\n./build/crucible -d -t trace.txt -l labels.txt program.xex\n```\n\n### Example 3: Working with ATR Images\n\n```bash\n# Boot from ATR image\n./build/crucible -I disk.atr\n\n# Run program with ATR image loaded\n./build/crucible -I disk.atr program.xex\n```\n\n### Example 4: Host Filesystem Access\n\n```bash\n# Set root path and run program\n./build/crucible -R /home/user/atari_files program.xex\n\n# Program can access files via H: device\n# H1:FILE.TXT maps to /home/user/atari_files/FILE.TXT\n```\n\n### Example 5: Profiling\n\n```bash\n# Generate profile\n./build/crucible -p profile.txt program.xex\n\n# View profile (shows cycle counts per instruction)\ncat profile.txt\n```\n\n## Troubleshooting\n\n### Program Doesn't Run\n\n- **Check file format**: Ensure file is valid XEX format\n- **Check debug output**: Use `-d` flag to see what's happening\n- **Check error level**: Use `-e full` to see all errors\n\n### ATR Image Not Loading\n\n- **Check file format**: Ensure ATR has valid header\n- **Check file size**: Supported up to 16MB\n- **Check sector size**: Must be 128 or 256 bytes\n\n### File Access Issues\n\n- **D: Device**: Requires ATR image loaded with `-I`\n- **H: Device**: Check root path with `-R` option\n- **Permissions**: Ensure files are readable/writable\n\n### Debug Output Too Verbose\n\n- **Use error levels**: `-e mem` or `-e none`\n- **Filter output**: Redirect stderr to file\n- **Use labels**: Makes trace output more readable\n\n### Performance Issues\n\n- **Use cycle-based timing**: `-o cycletime`\n- **Disable DOS**: `-D` flag if not needed\n- **Reduce debug output**: Remove `-d` flag\n\n### Common Error Messages\n\n- **\"can't open disk image\"**: Check file path and permissions\n- **\"invalid instruction\"**: Program may have bugs or incompatible code\n- **\"channel not open\"**: Program trying to access closed IOCB\n- **\"invalid command\"**: Unsupported CIO command\n\n### Getting Help\n\n- Use `-h` flag for command-line help\n- Check documentation in `docs/` folder\n- Review test files in `testfiles/` for examples\n- Enable debug output with `-d` flag\n\n## Advanced Usage\n\n### Custom I/O Handlers\n\nThe simulator supports custom character I/O handlers through the API (see API_REFERENCE.md for details).\n\n### Label File Format\n\nLabels can be specified in multiple formats:\n- `LABEL = $1234` (hexadecimal)\n- `LABEL = 1234` (decimal)\n- `LABEL = 0x1234` (hexadecimal with 0x prefix)\n\n### Profile Analysis\n\nProfile files show:\n- Cycle counts per instruction address\n- Branch statistics\n- Memory access patterns\n- Performance hotspots\n\n### Trace Analysis\n\nTrace files show:\n- Instruction execution sequence\n- Register values\n- Memory accesses\n- Call stack information\n\n## See Also\n\n- [Architecture Documentation](ARCHITECTURE.md) - Technical details\n- [API Reference](API_REFERENCE.md) - Developer documentation\n- [Building Guide](BUILDING.md) - Build system details\n- [Changelog](CHANGELOG.md) - Version history\n"},"currentPath":"user-guide"},"__N_SSG":true},"page":"/docs/[...slug]","query":{"slug":["crucible","user-guide"]},"buildId":"CnF04P5ob_bUVxETgw2P_","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>