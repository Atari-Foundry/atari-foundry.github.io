<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><title data-next-head="">CHANGELOG | crucible Documentation | Atari Foundry</title><meta name="description" content="crucible documentation: CHANGELOG" data-next-head=""/><link rel="preload" href="/images/foundry_logo_50H.png" as="image" data-next-head=""/><link rel="preload" href="/_next/static/chunks/c81f129e50a5fd79.css" as="style"/><link rel="stylesheet" href="/_next/static/chunks/c81f129e50a5fd79.css" data-n-g=""/><noscript data-n-css=""></noscript><script src="/_next/static/chunks/e8a4a4ae55bc5744.js" defer=""></script><script src="/_next/static/chunks/00dac80f236dcabb.js" defer=""></script><script src="/_next/static/chunks/44f6bc00d9aaf830.js" defer=""></script><script src="/_next/static/chunks/fd7cb30d70431a0f.js" defer=""></script><script src="/_next/static/chunks/turbopack-4769270d21ef6607.js" defer=""></script><script src="/_next/static/chunks/1b081b821847ed60.js" defer=""></script><script src="/_next/static/chunks/39b01aa8a3352426.js" defer=""></script><script src="/_next/static/chunks/b56fd671c61106a7.js" defer=""></script><script src="/_next/static/chunks/turbopack-ab1a8023ffca1f9c.js" defer=""></script><script src="/_next/static/uKcVMkypfjITnNYGcdC5l/_ssgManifest.js" defer=""></script><script src="/_next/static/uKcVMkypfjITnNYGcdC5l/_buildManifest.js" defer=""></script></head><body><div id="__next"><div class="crt"><div class="scanlines" aria-hidden="true"></div><div class="noise" aria-hidden="true"></div><nav class="nav"><a class="nav-brand" href="/"><img alt="Atari Foundry icon" width="72" height="50" decoding="async" data-nimg="1" style="color:transparent;height:40px;width:auto" src="/images/foundry_logo_50H.png"/><div><span class="nav-brand-title">Atari Foundry</span><span class="nav-brand-sub">Products for Atari 8-bit</span></div></a><ul class="nav-links"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/vault">Vault</a></li><li class="nav-item has-children"><button type="button" class="nav-link nav-trigger active" aria-haspopup="true" aria-expanded="false">Docs</button><div class="nav-dropdown"><a class="nav-dropdown-link" href="/docs/crucible">Crucible</a><a class="nav-dropdown-link" href="/docs/atrforge">atrforge</a><a class="nav-dropdown-link" href="/docs/forge">FORGE</a></div></li><li class="nav-item"><a class="nav-link" href="/support">Support</a></li></ul></nav><header class="subhero"><p class="label">crucible<!-- --> Documentation</p><h1 class="page-title">CHANGELOG</h1></header><main><div class="docs-layout"><aside class="docs-sidebar"><nav class="docs-nav"><div class="docs-nav-section"><h3>Documentation</h3><ul style="list-style:none;padding:0;margin:0"><li><a class="doc-link " style="padding-left:0rem" href="/docs/crucible/readme">README</a></li><li><a class="doc-link " style="padding-left:0rem" href="/docs/crucible/api-reference">API REFERENCE</a></li><li><a class="doc-link " style="padding-left:0rem" href="/docs/crucible/architecture">ARCHITECTURE</a></li><li><a class="doc-link " style="padding-left:0rem" href="/docs/crucible/attributions">ATTRIBUTIONS</a></li><li><a class="doc-link " style="padding-left:0rem" href="/docs/crucible/building">BUILDING</a></li><li><a class="doc-link active" style="padding-left:0rem" href="/docs/crucible/changelog">CHANGELOG</a></li><li><a class="doc-link " style="padding-left:0rem" href="/docs/crucible/user-guide">USER GUIDE</a></li></ul></div></nav></aside><div class="docs-content"><div class="docs-body"><div class="doc-markdown"><h1>Changelog</h1>
<p>All notable changes to crucible will be documented in this file.</p>
<p>The format is based on <a href="https://keepachangelog.com/en/1.0.0/" target="_blank" rel="noopener noreferrer" node="[object Object]">Keep a Changelog</a>,
and this project adheres to <a href="https://semver.org/spec/v2.0.0.html" target="_blank" rel="noopener noreferrer" node="[object Object]">Semantic Versioning</a>.</p>
<h2>[Unreleased] - 2026-01-21</h2>
<h3>Added</h3>
<ul>
<li>
<p><strong>ATR Filesystem Support</strong>: Full ATR image filesystem access for D: device</p>
<ul>
<li>Directory parsing for DOS 2.x, SpartaDOS, and BW-DOS formats</li>
<li>VTOC (Volume Table of Contents) reading</li>
<li>Sector chain following for file data access</li>
<li>Subdirectory navigation support</li>
<li>File attribute handling (locked, hidden, protected files)</li>
<li>Directory listing with SpartaDOS-style formatting</li>
<li>Support for ATR images up to 16MB (65535 sectors × 256 bytes)</li>
</ul>
</li>
<li>
<p><strong>H: Device</strong>: New host filesystem device</p>
<ul>
<li>Provides access to local host filesystem</li>
<li>Supports all standard file operations (OPEN, CLOSE, GET, PUT, POINT, NOTE)</li>
<li>Directory read support (mode 6)</li>
<li>Allows simultaneous access to ATR images (D:) and host files (H:)</li>
<li>Configurable root path via <code>-R</code> command-line option</li>
</ul>
</li>
<li>
<p><strong>Enhanced Hardware Emulation</strong>:</p>
<ul>
<li><strong>POKEY</strong>: Added support for audio/timer registers<!-- -->
<ul>
<li>AUDF1-4 ($D200, $D202, $D204, $D206) - Audio frequency registers</li>
<li>AUDC1-4 ($D201, $D203, $D205, $D207) - Audio control registers</li>
<li>AUDCTL ($D208) - Audio control register</li>
<li>KBCODE ($D209) - Keyboard code register</li>
<li>POT0-7 ($D200-$D207 when reading) - Potentiometer inputs</li>
</ul>
</li>
<li><strong>GTIA</strong>: Added register stubs for all GTIA registers ($D000-$D01F)<!-- -->
<ul>
<li>Player/Missile graphics registers</li>
<li>Color registers</li>
<li>Priority and control registers</li>
</ul>
</li>
<li><strong>ANTIC</strong>: Added register stubs for all ANTIC registers ($D400-$D40E)<!-- -->
<ul>
<li>DMA control, display list, scroll registers</li>
<li>Light pen and NMI registers</li>
</ul>
</li>
<li><strong>PIA</strong>: Enhanced support<!-- -->
<ul>
<li>PORTA register for joystick/paddle inputs</li>
<li>Control register support (PACTL, PBCTL)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Build System Improvements</strong>:</p>
<ul>
<li>Added <code>make clean</code> target for cleaning build artifacts</li>
<li>Added <code>make help</code> target for usage information</li>
<li>Added <code>make test</code> target for automated testing</li>
</ul>
</li>
<li>
<p><strong>Documentation</strong>:</p>
<ul>
<li>Comprehensive documentation in <code>docs/</code> folder</li>
<li>User guide, architecture documentation, API reference</li>
<li>Build instructions and troubleshooting guides</li>
</ul>
</li>
</ul>
<h3>Changed</h3>
<ul>
<li>
<p><strong>D: Device</strong>: Now exclusively uses ATR filesystem when ATR image is loaded</p>
<ul>
<li>Removed host filesystem fallback (use H: device instead)</li>
<li>Full directory parsing and file access from ATR images</li>
<li>Enhanced directory listing format with file attributes</li>
</ul>
</li>
<li>
<p><strong>H: Device Root Path</strong>: Now configurable via <code>-R</code> command-line option</p>
<ul>
<li>Previously defaulted to current directory (<code>.</code>)</li>
<li>Now uses same root path as D: device when <code>-R</code> is specified</li>
<li>Maintains backward compatibility with default behavior</li>
</ul>
</li>
<li>
<p><strong>Platform Compatibility</strong>:</p>
<ul>
<li>Improved cross-platform support for terminal input handling</li>
<li>Windows: Uses <code>CONIN$</code> for terminal input</li>
<li>Unix/Linux: Uses <code>/dev/tty</code> for terminal input</li>
</ul>
</li>
<li>
<p><strong>CIO System</strong>:</p>
<ul>
<li>Fixed RTS callback simulation in <code>sim_CIOV</code> for proper return address handling</li>
<li>Fixed stack preservation in <code>call_devtab</code> to prevent corruption from nested calls</li>
<li>All CIO operations now work correctly with proper return handling</li>
</ul>
</li>
</ul>
<h3>Fixed</h3>
<ul>
<li>
<p><strong>CIO Return Handling</strong>: Fixed critical bug where CIOV callbacks were not properly returning to caller</p>
<ul>
<li>Implemented RTS simulation in <code>sim_CIOV</code> to properly handle return addresses</li>
<li>Fixed stack corruption in nested device handler calls</li>
<li>All test programs now execute successfully</li>
</ul>
</li>
<li>
<p><strong>Hardcoded Paths</strong>: Removed hardcoded filesystem paths</p>
<ul>
<li>Made <code>/dev/tty</code> platform-specific with proper Windows support</li>
<li>Made H: device root path configurable via command-line</li>
</ul>
</li>
</ul>
<h3>Technical Details</h3>
<ul>
<li>New modules:<!-- -->
<ul>
<li><code>src/atrfs.c</code> / <code>src/atrfs.h</code> - ATR filesystem implementation</li>
<li><code>src/athost.c</code> / <code>src/athost.h</code> - H: device handler</li>
</ul>
</li>
<li>Modified modules:<!-- -->
<ul>
<li><code>src/atsio.c</code> / <code>src/atsio.h</code> - Added ATR access API</li>
<li><code>src/ataridos.c</code> - Integrated ATR filesystem</li>
<li><code>src/atcio.c</code> - Registered H: device, fixed RTS callback handling</li>
<li><code>src/hw.c</code> - Enhanced hardware register support</li>
<li><code>src/ciodev.h</code> - Added H: device definitions</li>
<li><code>src/main.c</code> - Added H: device root path configuration</li>
<li><code>src/atari.c</code> - Improved cross-platform terminal handling</li>
</ul>
</li>
</ul>
<h2>Previous Versions</h2>
<p>See git history for earlier changes from the original Mini65 project.</p></div></div></div></div></main><footer class="footer"><p>© 2026 Atari Foundry · Rick Collette · Software for Atari 8-bit builders.</p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"product":"crucible","productDocs":{"product":"crucible","files":[{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/README.md","relativePath":"README.md","relativeDir":"","filename":"README","slug":"readme","name":"README"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/API_REFERENCE.md","relativePath":"API_REFERENCE.md","relativeDir":"","filename":"API_REFERENCE","slug":"api-reference","name":"API REFERENCE"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ARCHITECTURE.md","relativePath":"ARCHITECTURE.md","relativeDir":"","filename":"ARCHITECTURE","slug":"architecture","name":"ARCHITECTURE"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ATTRIBUTIONS.md","relativePath":"ATTRIBUTIONS.md","relativeDir":"","filename":"ATTRIBUTIONS","slug":"attributions","name":"ATTRIBUTIONS"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/BUILDING.md","relativePath":"BUILDING.md","relativeDir":"","filename":"BUILDING","slug":"building","name":"BUILDING"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/CHANGELOG.md","relativePath":"CHANGELOG.md","relativeDir":"","filename":"CHANGELOG","slug":"changelog","name":"CHANGELOG"},{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/USER_GUIDE.md","relativePath":"USER_GUIDE.md","relativeDir":"","filename":"USER_GUIDE","slug":"user-guide","name":"USER GUIDE"}],"navTree":{"_files":[{"name":"README","slug":"readme","path":"README.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/README.md","isIndex":true},{"name":"API REFERENCE","slug":"api-reference","path":"API_REFERENCE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/API_REFERENCE.md","isIndex":false},{"name":"ARCHITECTURE","slug":"architecture","path":"ARCHITECTURE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ARCHITECTURE.md","isIndex":false},{"name":"ATTRIBUTIONS","slug":"attributions","path":"ATTRIBUTIONS.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/ATTRIBUTIONS.md","isIndex":false},{"name":"BUILDING","slug":"building","path":"BUILDING.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/BUILDING.md","isIndex":false},{"name":"CHANGELOG","slug":"changelog","path":"CHANGELOG.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/CHANGELOG.md","isIndex":false},{"name":"USER GUIDE","slug":"user-guide","path":"USER_GUIDE.md","fullPath":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/USER_GUIDE.md","isIndex":false}]}},"docFile":{"path":"/home/megalith/AtariProjects/AtariFoundry/www/PROJECT_DOCS/crucible/CHANGELOG.md","relativePath":"CHANGELOG.md","relativeDir":"","filename":"CHANGELOG","slug":"changelog","name":"CHANGELOG","content":"# Changelog\n\nAll notable changes to crucible will be documented in this file.\n\nThe format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),\nand this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).\n\n## [Unreleased] - 2026-01-21\n\n### Added\n\n- **ATR Filesystem Support**: Full ATR image filesystem access for D: device\n  - Directory parsing for DOS 2.x, SpartaDOS, and BW-DOS formats\n  - VTOC (Volume Table of Contents) reading\n  - Sector chain following for file data access\n  - Subdirectory navigation support\n  - File attribute handling (locked, hidden, protected files)\n  - Directory listing with SpartaDOS-style formatting\n  - Support for ATR images up to 16MB (65535 sectors × 256 bytes)\n\n- **H: Device**: New host filesystem device\n  - Provides access to local host filesystem\n  - Supports all standard file operations (OPEN, CLOSE, GET, PUT, POINT, NOTE)\n  - Directory read support (mode 6)\n  - Allows simultaneous access to ATR images (D:) and host files (H:)\n  - Configurable root path via `-R` command-line option\n\n- **Enhanced Hardware Emulation**:\n  - **POKEY**: Added support for audio/timer registers\n    - AUDF1-4 ($D200, $D202, $D204, $D206) - Audio frequency registers\n    - AUDC1-4 ($D201, $D203, $D205, $D207) - Audio control registers\n    - AUDCTL ($D208) - Audio control register\n    - KBCODE ($D209) - Keyboard code register\n    - POT0-7 ($D200-$D207 when reading) - Potentiometer inputs\n  - **GTIA**: Added register stubs for all GTIA registers ($D000-$D01F)\n    - Player/Missile graphics registers\n    - Color registers\n    - Priority and control registers\n  - **ANTIC**: Added register stubs for all ANTIC registers ($D400-$D40E)\n    - DMA control, display list, scroll registers\n    - Light pen and NMI registers\n  - **PIA**: Enhanced support\n    - PORTA register for joystick/paddle inputs\n    - Control register support (PACTL, PBCTL)\n\n- **Build System Improvements**:\n  - Added `make clean` target for cleaning build artifacts\n  - Added `make help` target for usage information\n  - Added `make test` target for automated testing\n\n- **Documentation**:\n  - Comprehensive documentation in `docs/` folder\n  - User guide, architecture documentation, API reference\n  - Build instructions and troubleshooting guides\n\n### Changed\n\n- **D: Device**: Now exclusively uses ATR filesystem when ATR image is loaded\n  - Removed host filesystem fallback (use H: device instead)\n  - Full directory parsing and file access from ATR images\n  - Enhanced directory listing format with file attributes\n\n- **H: Device Root Path**: Now configurable via `-R` command-line option\n  - Previously defaulted to current directory (`.`)\n  - Now uses same root path as D: device when `-R` is specified\n  - Maintains backward compatibility with default behavior\n\n- **Platform Compatibility**:\n  - Improved cross-platform support for terminal input handling\n  - Windows: Uses `CONIN$` for terminal input\n  - Unix/Linux: Uses `/dev/tty` for terminal input\n\n- **CIO System**:\n  - Fixed RTS callback simulation in `sim_CIOV` for proper return address handling\n  - Fixed stack preservation in `call_devtab` to prevent corruption from nested calls\n  - All CIO operations now work correctly with proper return handling\n\n### Fixed\n\n- **CIO Return Handling**: Fixed critical bug where CIOV callbacks were not properly returning to caller\n  - Implemented RTS simulation in `sim_CIOV` to properly handle return addresses\n  - Fixed stack corruption in nested device handler calls\n  - All test programs now execute successfully\n\n- **Hardcoded Paths**: Removed hardcoded filesystem paths\n  - Made `/dev/tty` platform-specific with proper Windows support\n  - Made H: device root path configurable via command-line\n\n### Technical Details\n- New modules:\n  - `src/atrfs.c` / `src/atrfs.h` - ATR filesystem implementation\n  - `src/athost.c` / `src/athost.h` - H: device handler\n- Modified modules:\n  - `src/atsio.c` / `src/atsio.h` - Added ATR access API\n  - `src/ataridos.c` - Integrated ATR filesystem\n  - `src/atcio.c` - Registered H: device, fixed RTS callback handling\n  - `src/hw.c` - Enhanced hardware register support\n  - `src/ciodev.h` - Added H: device definitions\n  - `src/main.c` - Added H: device root path configuration\n  - `src/atari.c` - Improved cross-platform terminal handling\n\n## Previous Versions\n\nSee git history for earlier changes from the original Mini65 project.\n"},"currentPath":"changelog"},"__N_SSG":true},"page":"/docs/[...slug]","query":{"slug":["crucible","changelog"]},"buildId":"uKcVMkypfjITnNYGcdC5l","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>